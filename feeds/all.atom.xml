<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>blog.y2kbugger.com</title><link href="http://blog.y2kbugger.com/" rel="alternate"></link><link href="http://blog.y2kbugger.com/feeds/all.atom.xml" rel="self"></link><id>http://blog.y2kbugger.com/</id><updated>2023-07-19T00:00:00-04:00</updated><entry><title>Applications of Artificial Intelligence in Materials Science</title><link href="http://blog.y2kbugger.com/2023-06-13-privatespeaker.html" rel="alternate"></link><published>2023-06-13T00:00:00-04:00</published><updated>2023-07-19T00:00:00-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2023-06-13:/2023-06-13-privatespeaker.html</id><summary type="html">&lt;p class="first last"&gt;Private Industry Guest Speaker, Ohio&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;Private Industry Guest Speaker&lt;/strong&gt;, &lt;em&gt;Ohio&lt;/em&gt;&lt;/p&gt;
&lt;!-- Google Photos Album: https://photos.app.goo.gl/dfXck6rcLDcZHtv17 --&gt;
&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;In this talk, we navigate the confluence of AI and materials science, addressing the transformative role of data. We begin by dissecting AI, elucidating its functionality and untapped potential for revolutionizing the way we approach materials science, especially within the rubber industry.&lt;/p&gt;
&lt;p&gt;We emphasize the significance of an 'Ever-Evolving Expert System' - a continuously adaptive AI system. Acting as a dynamic repository of knowledge, it augments human capabilities and consolidates wisdom from diverse data sources.&lt;/p&gt;
&lt;p&gt;This discussion aims to highlight the synergies between AI and materials science, promoting a future where the physical world and digital innovation coalesce seamlessly. From atoms to algorithms, we are on the precipice of a new era in materials science.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bio"&gt;
&lt;h2&gt;Bio&lt;/h2&gt;
&lt;p&gt;Zak Kohler&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Chemical Engineer (University of Akron)&lt;/li&gt;
&lt;li&gt;Programming for &amp;gt;20 years&lt;/li&gt;
&lt;li&gt;Led Predictive Analytics and Citizen Development for 5 years at Cooper Tires&lt;/li&gt;
&lt;li&gt;Presented at 5+ conferences since 2015 on Predictive Analytics and more&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="consulting-experience"&gt;
&lt;h3&gt;Consulting experience&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Stanford Biomedical Research Lab&lt;/li&gt;
&lt;li&gt;Semiconductor startup&lt;/li&gt;
&lt;li&gt;Data Analytics for a company in manufacturing&lt;/li&gt;
&lt;li&gt;Currently assisting with Predictive Lab Analytics at a Parker HPD&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="Programming AI material-science"></category></entry><entry><title>Baremetal RISC-V Renode - Part 3: Interrupts, C, and UART IO</title><link href="http://blog.y2kbugger.com/baremetal-riscv-renode-3.html" rel="alternate"></link><published>2021-12-13T00:00:00-05:00</published><updated>2021-12-13T00:00:00-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2021-12-13:/baremetal-riscv-renode-3.html</id><summary type="html">&lt;p class="first last"&gt;Explore the line between hardware and software while creating a minimal, vendor-free environment to write and play with toy operating systems.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/LUXeip6Xz85QRTn78
https://www.youtube.com/watch?v=D0VuYe77Wu0&amp;list=PLb-MsRpo_wlLW0EWRpAqnbbDsf4kxSI1x --&gt;
&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#baremetal-risc-v-renode-series" id="toc-entry-1"&gt;Baremetal RISC-V Renode Series&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#background" id="toc-entry-2"&gt;Background&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#adding-a-uart-to-renode" id="toc-entry-3"&gt;Adding a UART to Renode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-quick-note-about-using-c" id="toc-entry-4"&gt;A quick note about using C&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interrupt-handling" id="toc-entry-5"&gt;Interrupt Handling&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#risc-v-interrupts" id="toc-entry-6"&gt;RISC-V interrupts&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#driver-code" id="toc-entry-7"&gt;Driver Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#run-the-example" id="toc-entry-8"&gt;Run the example&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#next-post" id="toc-entry-9"&gt;Next post&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="baremetal-risc-v-renode-series"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-1"&gt;Baremetal RISC-V Renode Series&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I'm exploring the line between hardware and software by creating a series of demos within a minimal, free and open source environment. These demos span from blinking an LED to implementing a toy operating system. The goal is to minimize parts of the system that we take for granted and gain a better understanding of computers and operating systems.&lt;/p&gt;
&lt;p&gt;Start at &lt;a class="reference external" href="http://blog.y2kbugger.com/baremetal-riscv-renode-1.html"&gt;Part 1&lt;/a&gt;, we setup a bare minimum LED blinking example to demonstrate how to compile your development environment and debug the software in real-time using GDB.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="background"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-2"&gt;Background&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In this article we will be interfacing with a virtual UART. This will allow us to input and output a serial stream of character bytes.&lt;/p&gt;
&lt;p&gt;This example includes a few new concepts.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Interrupts&lt;/li&gt;
&lt;li&gt;C, including initialization&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="adding-a-uart-to-renode"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-3"&gt;Adding a UART to Renode&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We are using the UART from the Litex project. Litex is a High Level HDL project that makes it easy to design a system on a ship and target both simulations and FPGA.&lt;/p&gt;
&lt;p&gt;Because we are dealing with virtual hardware there isn't a datasheet. Instead we have 3 different code repositories that are useful for understanding the virtual hardware.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The actual Litex  &lt;a class="reference external" href="https://github.com/enjoy-digital/litex/blob/master/litex/soc/cores/uart.py"&gt;hardware description&lt;/a&gt; for the UART&lt;/li&gt;
&lt;li&gt;A &lt;a class="reference external" href="https://github.com/enjoy-digital/litex/blob/master/litex/soc/software/libbase/uart.c"&gt;UART driver&lt;/a&gt; also provided by the Litex project&lt;/li&gt;
&lt;li&gt;The Renode project provides a software &lt;a class="reference external" href="https://github.com/renode/renode-infrastructure/blob/master/src/Emulator/Peripherals/Peripherals/UART/LiteX_UART.cs"&gt;emulation&lt;/a&gt; of the Litex UART. This implements the hardware functionality without have to do a full verilog or gate-level simulation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To get the offsets and registers the easiest way was to look at the Renode emulation directly. You can see that&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;private&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;enum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registers&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;RxTx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TxFull&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;x04&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;RxEmpty&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;x08&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;EventStatus&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;x0c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;EventPending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;x10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;EventEnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="n"&gt;x14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The actual configuration of the UART hardware is a very simple addition:&lt;/p&gt;
&lt;p&gt;vexriscv.repl&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;...

uart: UART.LiteX_UART @ sysbus 0x60001800
    -&amp;gt; cpu@2
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All we needed to decide was where in memory to map the hardware, and what interrupt number to wire it to.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-quick-note-about-using-c"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-4"&gt;A quick note about using C&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This example is going to use C functions in addition to assembly.&lt;/p&gt;
&lt;p&gt;Since we are baremetal we need to set up the stack pointer ourselves.&lt;/p&gt;
&lt;p&gt;baremetal.s&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# setup a stack pointer&lt;/span&gt;
&lt;span class="nf"&gt;la&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;sp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;memtop&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="interrupt-handling"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-5"&gt;Interrupt Handling&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Interrupts are an asynchronous way to externally trigger the CPU to jump.&lt;/p&gt;
&lt;p&gt;Typically they jump to a particular memory location, or a location + an offset based on the reason for the interrupt.&lt;/p&gt;
&lt;div class="section" id="risc-v-interrupts"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-6"&gt;RISC-V interrupts&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;RISC-V interrupts come in two flavors, the original Core Local Interrupter (CLINT), and the Core Local Interrupt Controller (CLIC).
The difference between the two, and much more, is described in the sifive interrupt cookbook.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://sifive.cdn.prismic.io/sifive/0d163928-2128-42be-a75a-464df65e04e0_sifive-interrupt-cookbook.pdf"&gt;https://sifive.cdn.prismic.io/sifive/0d163928-2128-42be-a75a-464df65e04e0_sifive-interrupt-cookbook.pdf&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="driver-code"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-7"&gt;Driver Code&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;All that is left is to write the code to actually interact with the hardware.&lt;/p&gt;
&lt;p&gt;Note that we are going for understandability, not performance, so we are creating an unbuffered solution here.&lt;/p&gt;
&lt;p&gt;Define a hardware register map to memory.&lt;/p&gt;
&lt;p&gt;baremetal.c&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;typedef&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RxTx&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TxFull&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RxEmpty&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EventStatus&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EventPending&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EventEnable&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UART&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TxEvent&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mb"&gt;0b01&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;uint32_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RxEvent&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mb"&gt;0b10&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;volatile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UART&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;uart&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UART&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mh"&gt;0x60001800&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We need to set a flag in the UART to enable interrupt events.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;init_uart&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;uart&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;EventEnable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RxEvent&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is called in during startup, right before the final &lt;tt class="docutils literal"&gt;wfi&lt;/tt&gt; spin-loop.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;...&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# set mie.MEIE=1 (enable M mode external interrupts)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nf"&gt;li&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="no"&gt;t0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="no"&gt;b0000100000000000&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nf"&gt;csrrs&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="no"&gt;zero&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;mie&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;t0&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nf"&gt;call&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;init_uart&lt;/span&gt;

&lt;span class="nl"&gt;wait_for_interrupt:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nf"&gt;wfi&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nf"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;wait_for_interrupt&lt;/span&gt;
&lt;span class="na"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then we just need to specify what to do when an interrupt comes in.&lt;/p&gt;
&lt;p&gt;In the real world you would need to check the reason code and figure out:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;What type of interrupt are we handling&lt;/li&gt;
&lt;li&gt;What is the reason for the interrupt?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can safely ignore this for our demo because the only source of interrupts will be the UART receiving a character.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;interrupt_handler&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fancy_char&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;uart&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;RxTx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For fun, we echo the transmitted character surrounded by an ASCII art border.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;fancy_char&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;###&lt;/span&gt;&lt;span class="se"&gt;\n\r&lt;/span&gt;&lt;span class="s"&gt;#X#&lt;/span&gt;&lt;span class="se"&gt;\n\r&lt;/span&gt;&lt;span class="s"&gt;###&lt;/span&gt;&lt;span class="se"&gt;\n\r\n\r&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;putc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;uart&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;RxTx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;puts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;putc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;str&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="run-the-example"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-8"&gt;Run the example&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Ensure you have the setup from &lt;a class="reference external" href="http://blog.y2kbugger.com/baremetal-riscv-renode-1.html"&gt;Part 1&lt;/a&gt; completed.&lt;/p&gt;
&lt;p&gt;Switch to the folder &lt;tt class="docutils literal"&gt;3_uart&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;In one terminal run:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;then in another terminal:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;uart-poll
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;then you can send characters via the UART connection.&lt;/p&gt;
&lt;div class="figure align-left"&gt;
&lt;img alt="uart fancy echo demo" src="https://lh3.googleusercontent.com/pw/AM-JKLWBRQ2x4E66nGtG01cZwj8pHpktyqHNbFu-jPL4BldkuMT51PuDdQMCjAxspc5UlsWdlN-rky0GYTgTTVdnJo5k-_27zZ_ECc-95RBs0KeLv61zU0FYAZbv1HNzeQOYpGNNuvd85t99DtqatXXfeFysjw=w960-h423-no" /&gt;
&lt;p class="caption"&gt;Demo of the Fancy Character Echo&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="next-post"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-9"&gt;Next post&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In &lt;a class="reference external" href="http://blog.y2kbugger.com/drafts/baremetal-riscv-renode-4.html"&gt;Part 4&lt;/a&gt; we'll start to build the basics of a minimal preemptive multitasking toy OS called KOS as a way to learn more about baremetal programming. The first part we'll cover is how programs and processes are defined.&lt;/p&gt;
&lt;/div&gt;
</content><category term="programming"></category><category term="baremetal"></category><category term="RISC-V"></category><category term="Renode"></category><category term="assembly"></category><category term="CPUs"></category></entry><entry><title>A Simple RISC-V Multitasking OS for Learning</title><link href="http://blog.y2kbugger.com/2021-12-03-ohiolinuxfest.html" rel="alternate"></link><published>2021-12-03T00:00:00-05:00</published><updated>2021-12-03T00:00:00-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2021-12-03:/2021-12-03-ohiolinuxfest.html</id><summary type="html">&lt;p class="first last"&gt;Ohio Linuxfest 2021, Columbus, Ohio&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;Ohio Linuxfest&lt;/strong&gt;, &lt;em&gt;Columbus, Ohio&lt;/em&gt;&lt;/p&gt;
&lt;!-- Google Photos Album: https://photos.app.goo.gl/dfXck6rcLDcZHtv17 --&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.google.com/presentation/d/1BQ1FQoe7_6b0b84McHxIMIjrNTbw7o7dNMAjr6hmTFw/edit?usp=sharing"&gt;Slides&lt;/a&gt;&lt;/p&gt;
&lt;!-- `Blog Article (future) &lt;{filename}/programming/baremetal-riscv-renode-4.rst&gt;`_ --&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://github.com/y2kbugger/baremetal-riscv-renode.git
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="videoembed-container"&gt;
&lt;iframe class="videoembed-iframe" src="https://www.youtube.com/embed/LEBw4PUKlxg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;
&lt;/div&gt;&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Explore the line between hardware and software by writing code with absolute control over the cpu and peripherals. We'll explore how to do this using a completely free and open source simulator (Renode), toolchain (GCC), and instruction set (RISC-V). Using assembly, we'll initialize parts of the system such as CPU interrupts and privilege levels. Finally we'll review the assembly code for doing a context switch, the key software to which enables multitasking via timesharing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bio"&gt;
&lt;h2&gt;Bio&lt;/h2&gt;
&lt;p&gt;Zak Kohler is a Chemical Engineer by training but a hacker at heart. He started programming in 3rd grade and has never let up. His first foray in open source was in early high school, and he discovered Linux and Free Software at university. Electronics is his second love and he fuses the two by playing with early computer hardware, modern microcontrollers and FPGAs. When zak isn't messing with computers he can be found growing plants, drawing, and exploring the world on foot.&lt;/p&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="Ohio Linuxfest"></category><category term="baremetal"></category><category term="RISC-V"></category><category term="Renode"></category><category term="assembly"></category><category term="CPUs"></category></entry><entry><title>Baremetal RISC-V Renode - Part 2: Tool considerations</title><link href="http://blog.y2kbugger.com/baremetal-riscv-renode-2.html" rel="alternate"></link><published>2021-01-03T23:55:43-05:00</published><updated>2021-01-22T23:55:43-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2021-01-03:/baremetal-riscv-renode-2.html</id><summary type="html">&lt;p class="first last"&gt;A quick review of different simulators and toolchains that I have tried or heard about.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/LUXeip6Xz85QRTn78
https://www.youtube.com/watch?v=D0VuYe77Wu0&amp;list=PLb-MsRpo_wlLW0EWRpAqnbbDsf4kxSI1x --&gt;
&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#baremetal-risc-v-renode-series" id="toc-entry-1"&gt;Baremetal RISC-V Renode Series&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#background" id="toc-entry-2"&gt;Background&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#compiler-toolchains" id="toc-entry-3"&gt;Compiler toolchains&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#gcc" id="toc-entry-4"&gt;GCC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#llvm-clang" id="toc-entry-5"&gt;LLVM/Clang&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#simulators-emulators" id="toc-entry-6"&gt;Simulators/Emulators&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#renode" id="toc-entry-7"&gt;Renode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#qemu" id="toc-entry-8"&gt;Qemu&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#spike" id="toc-entry-9"&gt;Spike&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#educational" id="toc-entry-10"&gt;Educational&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#integrated-development-environments" id="toc-entry-11"&gt;Integrated Development environments&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#eclipse-cdt" id="toc-entry-12"&gt;Eclipse CDT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#platformio" id="toc-entry-13"&gt;Platformio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#vs-code" id="toc-entry-14"&gt;VS Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#litex-buildenv" id="toc-entry-15"&gt;litex buildenv&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#other" id="toc-entry-16"&gt;Other&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#operating-systems-sdk" id="toc-entry-17"&gt;Operating systems/SDK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#next-post" id="toc-entry-18"&gt;Next post&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="baremetal-risc-v-renode-series"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-1"&gt;Baremetal RISC-V Renode Series&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I'm exploring the line between hardware and software by creating a series of demos within a minimal, free and open source environment. These demos span from blinking an LED to implementing a toy operating system. The goal is to minimize parts of the system that we take for granted and gain a better understanding of computers and operating systems.&lt;/p&gt;
&lt;p&gt;Start at &lt;a class="reference external" href="http://blog.y2kbugger.com/baremetal-riscv-renode-1.html"&gt;Part 1&lt;/a&gt;, we setup a bare minimum LED blinking example to demonstrate how to compile your development environment and debug the software in real-time using GDB.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="background"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-2"&gt;Background&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This post catalogs the tools I tried as well as the tools I skipped over when developing the dev environment from Part 1. Comment below if I missed something or if something new has come out.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="compiler-toolchains"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-3"&gt;Compiler toolchains&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As stated in part one, because one goal is to run RISC-V binaries, we need a compiler that can run on an x86 PC, but compile to RISC-V bytecode.&lt;/p&gt;
&lt;div class="section" id="gcc"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-4"&gt;GCC&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In &lt;a class="reference external" href="http://blog.y2kbugger.com/baremetal-riscv-renode-1.html"&gt;Part 1&lt;/a&gt; we set up a RISC-V cross compiling GCC. To me, riscv-gnu-toolchain seemed to be the official C compiler for RISCV. Many other SDKs/IDEs are based on the gcc as well.&lt;/p&gt;
&lt;p&gt;I use riscv-gnu-toolchain instead of upstream gcc because it includes binutils and C library build configurations.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="llvm-clang"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-5"&gt;LLVM/Clang&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;As of September 2019, LLVM 9 has promoted the &lt;em&gt;experimental&lt;/em&gt; RISC-V backend to &lt;em&gt;official&lt;/em&gt;. The support has been prototyped as &lt;cite&gt;lowRISC&lt;/cite&gt; starting in 2016, which was then merged upstream as &lt;em&gt;experimental&lt;/em&gt; before being promoted to &lt;em&gt;official&lt;/em&gt;. This history indicates that there has probably been considerable testing, comment if you know of any production applications.&lt;/p&gt;
&lt;p&gt;LLVM has some features/warnings that GCC might be missing. It may also integrate with code analysis tools and autocompletion in a more streamlined way.&lt;/p&gt;
&lt;p&gt;One other thing I find interesting is that the main author of LLVM, Chris Lattner, has been &lt;a class="reference external" href="https://www.sifive.com/blog/with-sifive-we-can-change-the-world"&gt;hired by the RISC-V company SiFive&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="simulators-emulators"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-6"&gt;Simulators/Emulators&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In order to run non-native code, we need a simulator. This can be as simple as just translating the from one ISA to another, but it can also include peripherals and OS functionality, such as standard input output.&lt;/p&gt;
&lt;div class="section" id="renode"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-7"&gt;Renode&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I learned of Renode from the FPGA community. From what I can tell, they are able  high level hardware description language and compile it to either an FPGA bitstream or a Renode platform. This allows simulating an entire system, hardware and software together, without ever needing physical hardware and therefore, easier and more complete automatic testing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="qemu"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-8"&gt;Qemu&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Qemu a very popular emulation and virtualization tool. It is very useful for running non-native binaries within linux. Others use it for running guest operating systems. When I spent some time with it, I couldn't control the low-level details of the platform as much as Renode. A lot of complexity in the system seemed to revolve around PC peripherals, GUI, and virtualization that doesn't matter for trying to learn about baremetal programming. I also couldn't figure out a way to get rid of PC BIOS.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="spike"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-9"&gt;Spike&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Spike is a RISC-V specific emulator: &lt;a class="reference external" href="https://github.com/riscv/riscv-isa-sim"&gt;https://github.com/riscv/riscv-isa-sim&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I haven't tried this one myself. I looks like configurability is focused on customizing the CPU, e.g. custom opcodes, rather than IO or other embedded hardware.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="educational"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-10"&gt;Educational&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Below are a few graphical simulators that try to explain the execution as it is happening. These are targeted at understanding opcodes and other RISC-V specifics rather than actually programming for a hardware platform with peripherals.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://tice.sea.eseo.fr/riscv/"&gt;http://tice.sea.eseo.fr/riscv/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://ascslab.org/research/briscv/simulator/simulator.html"&gt;https://ascslab.org/research/briscv/simulator/simulator.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="integrated-development-environments"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-11"&gt;Integrated Development environments&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There are many good IDE solutions if your goal get work done on an embedded application, I discuss a few in detail below.&lt;/p&gt;
&lt;p&gt;These IDEs provide standard development tools such as compiler and debugger, but also support deploying to a board for testing and debugging on a board via JTAG or other hardware debugger.&lt;/p&gt;
&lt;p&gt;Some even support deploying to a simulator rather than real-work target. To me this is very valuable as it enables testing automation without requiring specific hardware.&lt;/p&gt;
&lt;div class="section" id="eclipse-cdt"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-12"&gt;Eclipse CDT&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;After figuring out the Java runtime and getting the versions of Eclipse and the CDT extension all working, I kinda ran out steam as every configuration was overly &amp;quot;eclipse centric&amp;quot;. I wanted to spend my time learning about embedded not learning about eclipse.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="platformio"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-13"&gt;Platformio&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Platformio is a universal embedded development extension for Microsoft's VS Code.&lt;/p&gt;
&lt;p&gt;Platformio describes itself as:&lt;/p&gt;
&lt;blockquote&gt;
Open source, cross-platform IDE and Unified Debugger. Static Code Analyzer and Remote Unit Testing. Multi-platform and Multi-architecture Build System.&lt;/blockquote&gt;
&lt;p&gt;I found that it was super convenient for &amp;quot;just getting starting&amp;quot; and getting stuff done. It is heavy but the extension bootstraps itself and the defaults are very sane. However, like eclipse, I didn't want to spend my time learning &amp;quot;how does Platformio work&amp;quot; every time I want to peek behind the curtain or tweak something low-level.&lt;/p&gt;
&lt;p&gt;Additionally, it only supported a handful of real boards when integrating with Renode, and it wasn't straightforward on how to customize the Renode platform and keep the integration working.&lt;/p&gt;
&lt;p&gt;Lastly, since it is a VS Code extension, we don't have a way to reproducibly build the platform and therefore any blog I write could go outdated as Platformio evolves.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Platformio screenshot" src="https://lh3.googleusercontent.com/pw/ACtC-3eEUNqaGzfNKQxydmtODWEllXemhHGT0fzswHlEIpK1-o6kQRy-xxHL1m7rXy64cLI5j_JHbVO4oqtAif-M9_Hn8XCUCGBlf6dCj-eDa-T7O2RWrMZZ86d-NbUUlHxEnBg3XXIWZUalZfbfj-oYOsRHIQ=w960-h494-no" /&gt;
&lt;p class="caption"&gt;Using Platformio to interact with registers, memory, source code and disassembly.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="vs-code"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-14"&gt;VS Code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I also tried to configure a handful different VS Code extensions to support our manually compiled GCC cross compiling toolchains. None ever ended up with better GDB support than the native GDB TUI. The three most promising were:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools"&gt;C/C++ for Visual Studio Code&lt;/a&gt; - Microsoft's official C extension. Configurable but not configurable enough.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=webfreak.debug"&gt;Native Debugger&lt;/a&gt; - This one seems like it could work, but I don't think I ever got it launching/debugging how I wanted it. It's open source so I think it could be done, even if it required more than just configuration.&lt;/li&gt;
&lt;li&gt;&lt;cite&gt;Cortex-Debug&lt;/cite&gt; &amp;lt;&lt;a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=marus25.cortex-debug"&gt;https://marketplace.visualstudio.com/items?itemName=marus25.cortex-debug&lt;/a&gt;&amp;gt;`_ Another open source extension. Although it is ARM specific, you provide your own gnu toolchain, so it may be viable.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="litex-buildenv"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-15"&gt;litex buildenv&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/timvideos/litex-buildenv"&gt;https://github.com/timvideos/litex-buildenv&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Litex buildenv is much more than just a way to compile code and get it running on real or simulated hardware. It actually facilitates specifying hardware in high level hardware description languages and compiling that down to create a soft CPU core on an FPGA. As part of the environment, it can be configured to deploy software to either a renode simulator, or to actual hardware.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="other"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-16"&gt;Other&lt;/a&gt;&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;IAR&lt;/li&gt;
&lt;li&gt;Segger&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://www.sam-solutions.com/blog/top-ten-embedded-software-development-tools/"&gt;https://www.sam-solutions.com/blog/top-ten-embedded-software-development-tools/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="operating-systems-sdk"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-17"&gt;Operating systems/SDK&lt;/a&gt;&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;freedom e sdk - &lt;a class="reference external" href="https://github.com/sifive/freedom-e-sdk"&gt;https://github.com/sifive/freedom-e-sdk&lt;/a&gt; This SDK is totally worth reading through and trying. You will learn a lot.&lt;/li&gt;
&lt;li&gt;Zephyr &lt;a class="reference external" href="https://www.zephyrproject.org/zephyr-an-operating-system-for-iot/"&gt;https://www.zephyrproject.org/zephyr-an-operating-system-for-iot/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Linux&lt;/li&gt;
&lt;li&gt;FreeRTOS&lt;/li&gt;
&lt;li&gt;MBed OS&lt;/li&gt;
&lt;li&gt;NuttX&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://micro-ros.github.io/docs/concepts/rtos/comparison/"&gt;https://micro-ros.github.io/docs/concepts/rtos/comparison/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="next-post"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-18"&gt;Next post&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In &lt;a class="reference external" href="http://blog.y2kbugger.com/baremetal-riscv-renode-2.html"&gt;Part 3&lt;/a&gt; I demonstrate basic IO via a hardware Serial UART. This introduces hardware interrupts and how to initialize, compile and link baremetal C along with the RISC-V assembly.&lt;/p&gt;
&lt;/div&gt;
</content><category term="programming"></category><category term="baremetal"></category><category term="RISC-V"></category><category term="Renode"></category><category term="assembly"></category><category term="CPUs"></category></entry><entry><title>Baremetal RISC-V Renode - Part 1: Blinky</title><link href="http://blog.y2kbugger.com/baremetal-riscv-renode-1.html" rel="alternate"></link><published>2020-12-22T00:11:42-05:00</published><updated>2020-12-22T00:11:42-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2020-12-22:/baremetal-riscv-renode-1.html</id><summary type="html">&lt;p class="first last"&gt;Explore the line between hardware and software while creating a minimal, vendor-free environment to write and play with toy operating systems.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/LUXeip6Xz85QRTn78
https://www.youtube.com/watch?v=D0VuYe77Wu0&amp;list=PLb-MsRpo_wlLW0EWRpAqnbbDsf4kxSI1x --&gt;
&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#background" id="toc-entry-1"&gt;Background&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#what-is-baremetal" id="toc-entry-2"&gt;What is baremetal?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#what-is-risc-v" id="toc-entry-3"&gt;What is RISC-V?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#what-is-renode" id="toc-entry-4"&gt;What is Renode?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#source-code" id="toc-entry-5"&gt;Source code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#toolchain-compilation" id="toc-entry-6"&gt;Toolchain compilation&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#building" id="toc-entry-7"&gt;Building&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#build-requirement-hints" id="toc-entry-8"&gt;Build requirement hints&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#activating-the-toolchains" id="toc-entry-9"&gt;Activating the toolchains&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#blinking-a-virtual-led" id="toc-entry-10"&gt;Blinking a virtual LED&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#just-get-it-running" id="toc-entry-11"&gt;Just get it running&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#hardware-configuration" id="toc-entry-12"&gt;Hardware configuration&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#blinky-source-code" id="toc-entry-13"&gt;Blinky source code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#building-an-elf-binary-using-gcc" id="toc-entry-14"&gt;Building an elf binary using gcc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interactively-debugging-renode" id="toc-entry-15"&gt;Interactively Debugging Renode&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#attaching-the-gnu-debugger" id="toc-entry-16"&gt;Attaching the GNU Debugger&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#useful-gdb-scenarios" id="toc-entry-17"&gt;Useful GDB scenarios&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#changing-the-bitmask-for-blinky" id="toc-entry-18"&gt;Changing the bitmask for blinky&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#miro-samek-and-the-modern-embedded-course-series" id="toc-entry-19"&gt;Miro Samek and the modern embedded course series&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#next-post" id="toc-entry-20"&gt;Next post&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#footnotes" id="toc-entry-21"&gt;Footnotes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="background"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-1"&gt;Background&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I'm exploring the line between hardware and software by creating a series of demos within a minimal, free and open source environment. These demos span from blinking an LED to implementing a toy operating system. The goal is to minimize parts of the system that we take for granted and gain a better understanding of computers and operating systems.&lt;/p&gt;
&lt;div class="section" id="what-is-baremetal"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-2"&gt;What is baremetal?&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In the non-embedded world, when you compile and link a C program into an executable you are doing so with the intention of running it &lt;em&gt;within&lt;/em&gt; a specific operating system. When you compile baremetal or &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-freestanding&lt;/span&gt;&lt;/tt&gt; you are telling the compiler that you intend to run this without relying on an operating system. This could be used, for example, to write an operating system. Alternatively it can be used to access the hardware of a system directly on an embedded system. Doing so sacrifices higher level luxuries such as memory management, standard IO, thread/process control, etc. Because of this, sometimes it makes sense to run on a type of minimal OS optimized for embedded, e.g. a real time operating system or RTOS.&lt;/p&gt;
&lt;p&gt;When you use a commercial development platform, you will likely be provided with a cross compiling toolchain and possibly an RTOS. For an example see &lt;a class="reference external" href="https://github.com/sifive/freedom-e-sdk"&gt;freedom-e-sdk&lt;/a&gt;. Alternatively, there are also attempts to make small, but hardware agonistic RTOS see &lt;a class="reference external" href="https://www.zephyrproject.org/"&gt;zephyr&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="what-is-risc-v"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-3"&gt;What is RISC-V?&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;RISC-V is an open alternative to ARM or x86.&lt;/p&gt;
&lt;p&gt;Wikipedia&lt;/p&gt;
&lt;blockquote&gt;
RISC-V (pronounced &amp;quot;risk-five&amp;quot;) is an open standard instruction set architecture (ISA) based on established reduced instruction set computer (RISC) principles. Unlike most other ISA designs, the RISC-V ISA is provided under open source licenses that do not require fees to use.&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="what-is-renode"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-4"&gt;What is Renode?&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Renode is a simulator designed for embedded firmware. What sets it apart is the goal of not only emulating CPUs and SOCs, but also entire boards with peripherals such as ethernet and even multi-node networks of devices.&lt;/p&gt;
&lt;p&gt;Alternatives such as QEMU aren't as optimized for the embedded space.&lt;/p&gt;
&lt;p&gt;An emulator that you might use for playing video game ROMs is specialized for a single platform. For example, in an emulator cpu, graphics chips, audio, memory-map, etc are fixed and optimized. Renode on the other hand configures each platform with a config file.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="source-code"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-5"&gt;Source code&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To get started you will need to clone the repository. This includes all of the examples as well as the source for Renode simulator and GCC RISC-V toolchain.&lt;/p&gt;
&lt;p&gt;Renode and GCC are linked via &lt;tt class="docutils literal"&gt;git submodule&lt;/tt&gt; so if you use &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--recursive&lt;/span&gt;&lt;/tt&gt; you can clone everything in one shot.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone --recursive https://github.com/y2kbugger/baremetal-riscv-renode.git
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="toolchain-compilation"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-6"&gt;Toolchain compilation&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Technically you could try to find these pre-compiled from your distro or elsewhere, but I suggest compiling from source to ensure we have matching versions and build options.&lt;/p&gt;
&lt;p&gt;There are some compilation prerequisites and gotchas. If my hints don't help, just refer to the official project documentation for each.&lt;/p&gt;
&lt;div class="section" id="building"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-7"&gt;Building&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To ease the burden on my own memory, I have added a &lt;tt class="docutils literal"&gt;Makefile&lt;/tt&gt; to capture the various build options for the toolchains. If you have all of the build requirements already installed, building both can be as simple as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;baremetal-riscv-renode
$&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;toolchains
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Running &lt;tt class="docutils literal"&gt;make toolchains&lt;/tt&gt; should usually be enough to let you know what you are missing. I have included some hints below, check the comments as well as different distros may have different packages.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="build-requirement-hints"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-8"&gt;Build requirement hints&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Below are my hints for which packages to install, this can be different depending on the distribution. I've also included links to the official guides for getting unstuck.&lt;/p&gt;
&lt;div class="section" id="gcc"&gt;
&lt;h4&gt;gcc&lt;/h4&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/riscv/riscv-gnu-toolchain"&gt;https://github.com/riscv/riscv-gnu-toolchain&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
gawk texinfo bison flex libncurses5-dev libncursesw5-dev
&lt;/pre&gt;
&lt;p&gt;The package &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;libncurses5-dev*&lt;/span&gt;&lt;/tt&gt; provides headers for &lt;tt class="docutils literal"&gt;ncurses&lt;/tt&gt;, and  &lt;tt class="docutils literal"&gt;texinfo&lt;/tt&gt; provides &lt;tt class="docutils literal"&gt;makeinfo&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="renode"&gt;
&lt;h4&gt;Renode&lt;/h4&gt;
&lt;p&gt;&lt;a class="reference external" href="https://renode.readthedocs.io/en/latest/advanced/building_from_sources.html"&gt;https://renode.readthedocs.io/en/latest/advanced/building_from_sources.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Mono provides the runtime and C# compiler required for Renode. Installing it can be tricky on some distros and having a mono that is incomplete or outdated can lead to hard to understand errors. Make sure your whole system is up-to-date if you run into issues compiling Renode.&lt;/p&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;Arch&lt;/dt&gt;
&lt;dd&gt;Everything worked fine using the &lt;tt class="docutils literal"&gt;mono&lt;/tt&gt; package from extra.&lt;/dd&gt;
&lt;dt&gt;Ubuntu&lt;/dt&gt;
&lt;dd&gt;&lt;strong&gt;Do not&lt;/strong&gt; use the mono from standard repos. Follow the instructions for &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;mono-complete&lt;/span&gt;&lt;/tt&gt; here &lt;a class="reference external" href="https://www.mono-project.com/download/stable/"&gt;https://www.mono-project.com/download/stable/&lt;/a&gt;.&lt;/dd&gt;
&lt;/dl&gt;
&lt;pre class="code literal-block"&gt;
automake autoconf libtool g++ coreutils policykit-1 libgtk2.0-dev screen uml-utilities gtk-sharp2 python3
&lt;/pre&gt;
&lt;p&gt;The package &lt;tt class="docutils literal"&gt;coreutils&lt;/tt&gt; provides &lt;tt class="docutils literal"&gt;realpath&lt;/tt&gt; on Debian.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="activating-the-toolchains"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-9"&gt;Activating the toolchains&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Beyond here, we assume both renode and riscv-gcc are on your &lt;tt class="docutils literal"&gt;PATH&lt;/tt&gt;. To accomplish this, you can source this activation script.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;activate-toolchains.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="blinking-a-virtual-led"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-10"&gt;Blinking a virtual LED&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To verify and get familiar with the tools we'll start off with the &amp;quot;Hello, World&amp;quot; of hardware projects: blinking an LED.&lt;/p&gt;
&lt;p&gt;Blinking a virtual &amp;quot;LED&amp;quot; involves a few steps:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Build &lt;strong&gt;image&lt;/strong&gt; from source code&lt;/li&gt;
&lt;li&gt;Launch the hardware &lt;strong&gt;simulator&lt;/strong&gt; configured by the platform (repl) file&lt;/li&gt;
&lt;li&gt;Load the image into &lt;strong&gt;RAM&lt;/strong&gt; of the simulator&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="section" id="just-get-it-running"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-11"&gt;Just get it running&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;First open up the project folder:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ cd 1_blinky
&lt;/pre&gt;
&lt;p&gt;Then following command will handle all steps 1-3, we'll break this down later:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ make launch
&lt;/pre&gt;
&lt;p&gt;If everything went correctly, you should see something like this:&lt;/p&gt;
&lt;img alt="blinky demo running" src="https://lh3.googleusercontent.com/pw/ACtC-3dKs20yaz1biM2MWXyi7HAcI0pb-BHYDYD1XM92Al11dQPQ26OJY8YULAlHPHtduGETCN5Y5D6aXtkiFi3-9tB3RNtj4A687SGo765evyqri2TjKMCyQeNSLNfZ-SV52yXlIEar9iQj2aEzPKAmBGrQOA=w628-h449-no" /&gt;
&lt;p&gt;You should have also noticed the monitor window open up. This is used to control the running renode machine; the &lt;tt class="docutils literal"&gt;?&lt;/tt&gt; command will list the rest. The tab completion is also very helpful.&lt;/p&gt;
&lt;img alt="renode monitor" src="https://lh3.googleusercontent.com/pw/ACtC-3f6eXxClG8aqr6wk2twPPD-lXLA7C4vskcZkecZVwPlqSYNCrxrdtvzBSEgK0YLixLm3OuJzJeM63alK8B1ATSZUp594xdfz2u8-vQeMlTSLMRl_ihZHDEQtH4scresowV29jguNfTZpzdqeX1sTttQng=w442-h197-no" /&gt;
&lt;p&gt;Quit using &lt;tt class="docutils literal"&gt;q&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;quit&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
(vexriscv-machine) quit
&lt;/pre&gt;
&lt;p&gt;Alternatively you can kill renode using &lt;tt class="docutils literal"&gt;CTRL&lt;/tt&gt; + &lt;tt class="docutils literal"&gt;C&lt;/tt&gt; in the terminal that you launched it from.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="hardware-configuration"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-12"&gt;Hardware configuration&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The hardware to will be simulated is defined using a renode specific platform description format &lt;a class="footnote-reference" href="#renode-describing-platforms" id="footnote-reference-1"&gt;[3]&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;vexriscv.repl:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mem: Memory.MappedMemory &amp;#64; sysbus 0x0
    size: 0x00040000

cpu: CPU.VexRiscv &amp;#64; sysbus

gpio_out: GPIOPort.LiteX_GPIO &amp;#64; sysbus 0x60000800
    type: Type.Out
    0 -&amp;gt; led0&amp;#64;0
    1 -&amp;gt; led1&amp;#64;0

led0 : Miscellaneous.LED &amp;#64; gpio_out 0
led1 : Miscellaneous.LED &amp;#64; gpio_out 1
&lt;/pre&gt;
&lt;p&gt;I like this because we can make a very minimal hardware configuration, free from any vendor specific complexity. Besides the cpu and memory, we have a general purpose input output (GPIO) register mapped to memory location &lt;tt class="docutils literal"&gt;0x60000800&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&amp;gt;&lt;/span&gt;&lt;/tt&gt; makes a connection from the GPIO pins to the LEDs. I don't exactly know why we need both &lt;tt class="docutils literal"&gt;0 &lt;span class="pre"&gt;-&amp;gt;&lt;/span&gt; led0&amp;#64;0&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&amp;#64; gpio_out 0&lt;/tt&gt; as it seems redundant; if anyone knows, please let me know. You'll also commonly see  &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-&amp;gt;&lt;/span&gt;&lt;/tt&gt; used for connecting interrupts.&lt;/p&gt;
&lt;p&gt;To toggle the LED we will need to write a driver that knows how to control the GPIO by writing to it's register.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="blinky-source-code"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-13"&gt;Blinky source code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This initial program is written exclusively in RISC-V assembly &lt;a class="footnote-reference" href="#riscv-prgrammers-guide" id="footnote-reference-2"&gt;[4]&lt;/a&gt; this is simple enough that every instruction that gets executed can be traced to this source file.&lt;/p&gt;
&lt;p&gt;The code to drive this GPIO device is dead simple, you just need to write data to the memory location that maps to the GPIO pins.&lt;/p&gt;
&lt;p&gt;Note that the platform specifies the mapping of &lt;tt class="docutils literal"&gt;0x60000800&lt;/tt&gt; to the GPIO register.&lt;/p&gt;
&lt;p&gt;baremetal.s:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;.equ&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;LED&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0x60000800&lt;/span&gt;
&lt;span class="na"&gt;.equ&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;DELAY_COUNT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9000000&lt;/span&gt;
&lt;span class="na"&gt;.equ&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;LED_STATE_INITIAL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="no"&gt;b00&lt;/span&gt;
&lt;span class="na"&gt;.equ&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;LED_STATE_TOGGLE_MASK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="no"&gt;b01&lt;/span&gt;

&lt;span class="na"&gt;.section&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;.text&lt;/span&gt;
&lt;span class="na"&gt;.global&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;_start&lt;/span&gt;
&lt;span class="nl"&gt;_start:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;li&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;LED&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;li&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;LED_STATE_INITIAL&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;li&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;LED_STATE_TOGGLE_MASK&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;sw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;a5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nl"&gt;loop:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;li&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;DELAY_COUNT&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# reset counter&lt;/span&gt;
&lt;span class="nl"&gt;delay_loop:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;addi&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;-1&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# count down&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;bnez&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;delay_loop&lt;/span&gt;
&lt;span class="nl"&gt;toggle_led:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;lw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;a5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# read in old led state&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;xor&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a6&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# toggle led state word&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;sw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;a4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;a5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# write new state&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nf"&gt;jump&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;t0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="building-an-elf-binary-using-gcc"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-14"&gt;Building an elf binary using gcc&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;GCC will build an ELF binary based on our assembly source code. This binary is the ROM image and Renode is the emulator.&lt;/p&gt;
&lt;p&gt;By default, gcc outputs a format called ELF. This format is understood and loaded by the OS, &lt;a class="reference external" href="https://lwn.net/Articles/631631/"&gt;i.e. linux,&lt;/a&gt;. Renode also has the ability to understand ELF files and will load the sections into memory and put the program counter at the right spot to start executing &lt;a class="footnote-reference" href="#renode-elf-start" id="footnote-reference-3"&gt;[1]&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;riscv32-unknown-elf-gcc&lt;span class="w"&gt; &lt;/span&gt;baremetal.s&lt;span class="w"&gt; &lt;/span&gt;baremetal.c&lt;span class="w"&gt; &lt;/span&gt;-ggdb&lt;span class="w"&gt; &lt;/span&gt;-O0&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;image&lt;span class="w"&gt; &lt;/span&gt;-ffreestanding&lt;span class="w"&gt; &lt;/span&gt;-nostdlib
&lt;/pre&gt;&lt;/div&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;riscv32-unknown-elf-gcc&lt;/dt&gt;
&lt;dd&gt;gnu compiler. This compiles, assembles, and links input source code. This is the special cross compiling variant that we built earlier which runs on your host architecture (e.g. x86), but outputs binaries for riscv32.&lt;/dd&gt;
&lt;dt&gt;baremetal.s&lt;/dt&gt;
&lt;dd&gt;Assemble source file.&lt;/dd&gt;
&lt;/dl&gt;
&lt;table class="docutils option-list" frame="void" rules="none"&gt;
&lt;col class="option" /&gt;
&lt;col class="description" /&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="option-group"&gt;
&lt;kbd&gt;&lt;span class="option"&gt;-g&lt;var&gt;gdb&lt;/var&gt;&lt;/span&gt;&lt;/kbd&gt;&lt;/td&gt;
&lt;td&gt;Turn on debugging symbols so that gdb can reference memory locations by name.&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class="option-group"&gt;
&lt;kbd&gt;&lt;span class="option"&gt;-O&lt;/span&gt;&lt;/kbd&gt;&lt;/td&gt;
&lt;td&gt;Sets the optimization level, 0 for off&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class="option-group"&gt;
&lt;kbd&gt;&lt;span class="option"&gt;-o &lt;var&gt;image&lt;/var&gt;&lt;/span&gt;&lt;/kbd&gt;&lt;/td&gt;
&lt;td&gt;Name of the output ELF binary&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class="option-group"&gt;
&lt;kbd&gt;&lt;span class="option"&gt;-f&lt;var&gt;freestanding&lt;/var&gt;&lt;/span&gt;&lt;/kbd&gt;&lt;/td&gt;
&lt;td&gt;don't use or require main. Don't assume we have an operating system.&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td class="option-group"&gt;
&lt;kbd&gt;&lt;span class="option"&gt;-n&lt;var&gt;ostdlib&lt;/var&gt;&lt;/span&gt;&lt;/kbd&gt;&lt;/td&gt;
&lt;td&gt;don't rely on c standard libraries being available.&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="section" id="interactively-debugging-renode"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-15"&gt;Interactively Debugging Renode&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Pause and step though code that is running on the simulator.&lt;/p&gt;
&lt;div class="section" id="attaching-the-gnu-debugger"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-16"&gt;Attaching the GNU Debugger&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;After launching, you may attach GDB using &lt;cite&gt;make debug&lt;/cite&gt;. This connects to the GDB server already running within Renode. It uses a GDB script to store default configuration, such as breaking execution and starting the text user interface or TUI, which shows source code alongside the disassembly.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;launch
$&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;debug
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you are familiar with GDB you know the power of setting breakpoint, inspecting stacks, and much much more.&lt;/p&gt;
&lt;div class="figure align-left"&gt;
&lt;img alt="gdb tui" src="https://lh3.googleusercontent.com/pw/ACtC-3chg3Hd7-XPkvOum0SQv3f9EZ30vjZ3BB70OMbEqWVWO9GkvjOh-sBBWg-cU_oD2xo7jj4TTvQReAX-2F4HSt6OPOur1bb06A-fQZUti-STZ0clEEkYPsCrHAhMq2rVkKLU2psnCGzE_pfs5rIWrda0xg=w454-h669-no" /&gt;
&lt;p class="caption"&gt;GDB Text User Interface (TUI)&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="useful-gdb-scenarios"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-17"&gt;Useful GDB scenarios&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;There are a couple simple commands that I find to be useful when exploring baremetal programming.&lt;/p&gt;
&lt;div class="section" id="step-a-single-instruction"&gt;
&lt;h4&gt;Step a single instruction&lt;/h4&gt;
&lt;p&gt;Type &lt;tt class="docutils literal"&gt;S&lt;/tt&gt; &lt;tt class="docutils literal"&gt;I&lt;/tt&gt; &lt;tt class="docutils literal"&gt;Enter&lt;/tt&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) si
(gdb) █
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To repeat the last command, just repeatedly hit &lt;tt class="docutils literal"&gt;Enter&lt;/tt&gt;. This makes it easy to single step through the program.&lt;/p&gt;
&lt;p&gt;You will notice that you get stuck in the delay loop, you would have to hit &lt;tt class="docutils literal"&gt;Enter&lt;/tt&gt; 9,000,000 times to make it though that delay. This is not a good way to add delays since it uses 100% of the CPU. If we were building an operating system, we could utilize a hardware timer and allow programs to request sleeps through an API. During the sleep the OS could go about running other processes, and then wake up the sleeping process at the appropriate time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="continue-normal-execution"&gt;
&lt;h4&gt;Continue normal execution&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) c
Continuing.
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="break-normal-execution"&gt;
&lt;h4&gt;Break normal execution&lt;/h4&gt;
&lt;p&gt;Send a keyboard interrupt, e.g. &lt;tt class="docutils literal"&gt;CTRL&lt;/tt&gt; + &lt;tt class="docutils literal"&gt;C&lt;/tt&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) c
Continuing.

Program received signal SIGTRAP, Trace/breakpoint trap.
delay_loop () at baremetal.s:13
(gdb) █
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="set-a-breakpoint"&gt;
&lt;h4&gt;Set a breakpoint&lt;/h4&gt;
&lt;p&gt;You can set a breakpoint at a line or symbol. Tab completion should work here to display available symbols. So &lt;tt class="docutils literal"&gt;B&lt;/tt&gt; &lt;tt class="docutils literal"&gt;Space&lt;/tt&gt; &lt;tt class="docutils literal"&gt;T&lt;/tt&gt; &lt;tt class="docutils literal"&gt;Tab&lt;/tt&gt; &lt;tt class="docutils literal"&gt;Enter&lt;/tt&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) b toggle_led
Breakpoint 1 at 0x10074: file baremetal.s, line 16.
(gdb) c
Continuing.

Breakpoint 1, toggle_led () at baremetal.s:16
(gdb) █
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="read-registers"&gt;
&lt;h4&gt;Read Registers&lt;/h4&gt;
&lt;p&gt;You can dump all registers,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) info registers
    ra             0x0      0x0
    fp             0x0      0x0
    s1             0x0      0
    a0             0x24648f 2385039
    ...
    t4             0x0      0
    t5             0x0      0
    t6             0x0      0
    pc             0x1006c  0x1006c &amp;lt;delay_loop&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or you can print a specific one:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) p $pc
$5 = (void (*)()) 0x10074 &amp;lt;toggle_led&amp;gt;
(gdb) p $a4
$6 = 2
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="setting-a-register"&gt;
&lt;h4&gt;Setting a register&lt;/h4&gt;
&lt;p&gt;You can mutate a register value and continue on:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) set $pc=delay_loop
(gdb) c
Continuing.
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="changing-the-bitmask-for-blinky"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-18"&gt;Changing the bitmask for blinky&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let's do something fun and prove we can modify a program's state after breaking.&lt;/p&gt;
&lt;p&gt;If we just run the blinky example, note that we are blinking &lt;tt class="docutils literal"&gt;led0&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;15:09:23.7671 [NOISY] gpio_out.led0: LED state changed to True
15:09:24.0805 [NOISY] gpio_out.led0: LED state changed to False
15:09:24.3872 [NOISY] gpio_out.led0: LED state changed to True
15:09:24.7525 [NOISY] gpio_out.led0: LED state changed to False
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Change the bitmask:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;(gdb) set $a6=0b10
(gdb) c
Continuing.
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now we are blinking &lt;tt class="docutils literal"&gt;led1&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;led0&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;15:09:42.5007 [NOISY] gpio_out.led1: LED state changed to True
15:09:42.7653 [NOISY] gpio_out.led1: LED state changed to False
15:09:43.0602 [NOISY] gpio_out.led1: LED state changed to True
15:09:43.3263 [NOISY] gpio_out.led1: LED state changed to False
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="miro-samek-and-the-modern-embedded-course-series"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-19"&gt;Miro Samek and the modern embedded course series&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I am inspired by Miro Samek. He does a great introduction to many embedded programming concepts and I want to share that in a way that we don't need to have a real board.&lt;/p&gt;
&lt;p&gt;Check out his course here: &lt;a class="reference external" href="https://www.state-machine.com/quickstart/"&gt;https://www.state-machine.com/quickstart/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="next-post"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-20"&gt;Next post&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In &lt;a class="reference external" href="http://blog.y2kbugger.com/baremetal-riscv-renode-2.html"&gt;Part 2&lt;/a&gt; I review a list alternate dev environment and how I converged on what I've described here. There are many easier and more &lt;em&gt;complete/integrated&lt;/em&gt; solutions, but we have a stated goal of gaining understanding and this is a forcing function for more control over details.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="footnotes"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-21"&gt;Footnotes&lt;/a&gt;&lt;/h2&gt;
&lt;table class="docutils footnote" frame="void" id="renode-elf-start" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-3"&gt;[1]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;p class="first"&gt;The computer has to start executing somewhere on reset, the exact memory location is called the reset vector and on RISC-V it is implementation dependent and Renode coordinates the reset vector in its simulator with the memory address of the &lt;a class="reference external" href="https://refspecs.linuxfoundation.org/elf/gabi4+/ch4.eheader.html"&gt;e_entry header&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/renode/renode-infrastructure/blob/8ad326eefe85acc127fdb01d70dbbc9a6a99dca8/src/Emulator/Peripherals/Peripherals/CPU/TranslationCPU.cs#L107"&gt;Renode changes the reset vector based on the ELF binary&lt;/a&gt;&lt;/p&gt;
&lt;div class="last"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LogLevel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Info&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Setting PC value to 0x{0:X}.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetEntryPoint&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
&lt;span class="n"&gt;SetPCFromEntryPoint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GetEntryPoint&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="renode-machine" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;[2]&lt;/td&gt;&lt;td&gt;&lt;a class="reference external" href="https://renode.readthedocs.io/en/latest/basic/machines.html"&gt;https://renode.readthedocs.io/en/latest/basic/machines.html&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="renode-describing-platforms" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-1"&gt;[3]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a class="reference external" href="https://renode.readthedocs.io/en/latest/basic/describing_platforms.html"&gt;https://renode.readthedocs.io/en/latest/basic/describing_platforms.html&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="riscv-prgrammers-guide" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-2"&gt;[4]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a class="reference external" href="https://github.com/riscv/riscv-asm-manual/blob/master/riscv-asm.md"&gt;https://github.com/riscv/riscv-asm-manual/blob/master/riscv-asm.md&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</content><category term="programming"></category><category term="baremetal"></category><category term="RISC-V"></category><category term="Renode"></category><category term="assembly"></category><category term="CPUs"></category></entry><entry><title>Baremetal RISC-V Renode</title><link href="http://blog.y2kbugger.com/2020-11-06-ohiolinuxfest.html" rel="alternate"></link><published>2020-11-06T00:00:00-05:00</published><updated>2020-11-06T00:00:00-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2020-11-06:/2020-11-06-ohiolinuxfest.html</id><summary type="html">&lt;p class="first last"&gt;Ohio Linuxfest 2020, Virtual&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;Ohio Linuxfest&lt;/strong&gt;, &lt;em&gt;Virtual&lt;/em&gt;&lt;/p&gt;
&lt;!-- Google Photos Album: https://photos.app.goo.gl/LUXeip6Xz85QRTn78 --&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.google.com/presentation/d/1BnCyFaq_yDQMpGsGNcsVLQeVmer9JnVh4CuCS1wOK_c/edit?usp=sharing"&gt;Slides&lt;/a&gt;
&lt;a class="reference external" href="http://blog.y2kbugger.com/baremetal-riscv-renode-1.html"&gt;Main Blog Article&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://github.com/y2kbugger/baremetal-riscv-renode.git
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="videoembed-container"&gt;
&lt;iframe class="videoembed-iframe" src="https://www.youtube.com/embed/JkeRezvCVfM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Explore the line between hardware and software by writing code with absolute control over the cpu and peripherals. We’ll explore how to do this using a completely free and open source simulator (Renode), toolchain (GCC), and instruction set (RISC-V). Using assembly, we’ll initialize parts of the system such as CPU interrupts and privilege levels, and setting up a call stack so we can use C. Using C we’ll build a handler for serial IO. Finally we’ll talk about the next steps in building a toy operating system such as building a simple monitor menu, memory management, and multitasking.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bio"&gt;
&lt;h2&gt;Bio&lt;/h2&gt;
&lt;p&gt;Zak Kohler is a Chemical Engineer by education but true computer geek at heart. He started programming in 3rd grade and has never looked back. Often zak states that his biggest regret is not finding Python and Linux sooner...that didn't happen until university. Electronics is his second love and he fuses the two by playing with early computer hardware as well as modern microcontrollers. When zak isn't messing with computers he can be found turning milk into cheese, drawing, or exploring the world on long walks.&lt;/p&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="Ohio Linuxfest"></category><category term="baremetal"></category><category term="RISC-V"></category><category term="Renode"></category><category term="assembly"></category><category term="CPUs"></category></entry><entry><title>I am now a maintainer on the Arch User Repository</title><link href="http://blog.y2kbugger.com/first_arch_user_repository_submission.html" rel="alternate"></link><published>2020-04-14T00:06:28-04:00</published><updated>2020-12-14T12:09:04-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2020-04-14:/first_arch_user_repository_submission.html</id><summary type="html">&lt;p class="first last"&gt;Just made my first submission to the arch user repository (AUR)&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/dfXck6rcLDcZHtv17 --&gt;
&lt;div class="section" id="long-time-user-first-time-maintainer"&gt;
&lt;h2&gt;Long time user, first time maintainer&lt;/h2&gt;
&lt;p&gt;I've been a Linux user for a decade now, Ubuntu at first, but I switched to &lt;a class="reference external" href="https://archlinux.org"&gt;ArchLinux&lt;/a&gt; after a year or two. I quickly found the &lt;a class="reference external" href="https://aur.archlinux.org/"&gt;Arch User Repository&lt;/a&gt; or AUR to be a treasure trove of free (libre) software; I am still in awe today. On ms windows, finding software meant downloading binaries from sketchy freeware sites. The prospects were better on Ubuntu since many software projects engaged with the community and produces regular releases. One drawback however were the stale repos, some packages on ubuntu were still pointing at releases that were years old.The Ubuntu &lt;a class="reference external" href="https://launchpad.net/ubuntu/+ppas"&gt;Personal Package Archives&lt;/a&gt; PPAs was supposed to solve this, but I never had  good luck with them. The packages always seemed random whether or not they were compatible and maintained.&lt;/p&gt;
&lt;img alt="ArchLinux Logo" src="https://lh3.googleusercontent.com/mapAQeHjDZmDn4Jq-FXyEhuFDEB6IHuEBzk8egTflCpiwLU9g0-W_YevSXbZEE-tQopVtEIJLO_rkjgf2TjA_olTqV7gGPiiDPKliO23xXNlOENJnDhobYLeLh7w942lCrhiASjMVHA=w683-h228-no" /&gt;
&lt;p&gt;Enter ArchLinux, everything is on the bleeding edge. The vast majority of typical software needs is packaged and up-to-date. For more custom software, there is the AUR. It started as just people sharing recipes for building packages...and well, that's still the case and it's a &lt;em&gt;really&lt;/em&gt; good thing too, it's beauty is in the simplicity. Packaging makes sure that the software you install goes in cleanly and can be removed without leftover files. You can think of ArchLinux as basically a package manger &lt;a class="footnote-reference" href="#pacman" id="footnote-reference-1"&gt;[1]&lt;/a&gt; and a wonderful community. The AUR acts as a funnel for new packages to become official in the community repository, which are built packages rather than just recipes.&lt;/p&gt;
&lt;table class="docutils footnote" frame="void" id="pacman" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-1"&gt;[1]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;See pacman: &lt;a class="reference external" href="https://wiki.archlinux.org/index.php/pacman"&gt;https://wiki.archlinux.org/index.php/pacman&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class="section" id="my-contribution"&gt;
&lt;h2&gt;My contribution&lt;/h2&gt;
&lt;p&gt;For my first contribution I wanted something simple, just to learn the process. At work I have been spending a lot of time with the conda package manager, and a few months ago I submitted my first conda-forge recipe. For a long time I have wanted to put something on AUR and now that packing is fresh on my mind I figure it's a good time to get this one under my belt. I chose a shell script that I have used for years; it is a fork of a now deleted AUR package. Since it's a shell script it still needs to be installed to the system but it doesn't have the complication of needing to be compiled.&lt;/p&gt;
&lt;img alt="My AUR package page" src="https://lh3.googleusercontent.com/Cc_WYvWQQrft1j2Qgb6mjuLL5t1zpBXlPVjViDqeBuPgJLK0Spus6pszYoEhzmO5gTY-NH2uJ44rq1CyeDapBKiJhOkhAKwJc77_sZpWv9JL9qgza5Yawd9ilg58bau2i1nR8vu6xEk=w503-h216-no" /&gt;
&lt;p&gt;The package is called &lt;cite&gt;dmenu-recent-aliases&lt;/cite&gt;, and it is a lightweight application launcher. It provides fuzzy searching for all the executables on your &lt;cite&gt;PATH&lt;/cite&gt; and also includes your custom bash functions and aliases. I have added a few extra features as well, for the full docs see &lt;a class="reference external" href="https://gitlab.com/y2kbugger-projects/scripts/dmenu-recent-aliases"&gt;https://gitlab.com/y2kbugger-projects/scripts/dmenu-recent-aliases&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A second reason for choosing this one is that there is some demand for the script and the original is no longer being maintained.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Broken link on aur" src="https://lh3.googleusercontent.com/oh9j6EPpcdpLD-1pWDsRzv18wSoKxlbB_bMcunePT2W8DGunnHpAswL7riiCzTgzkyiQ_I0h_00VP-mDrfH3ZeHMmnCwn9PtHVUu219CopWoYB7GI-NQell_BQ3yM096_IMTp5bAXlk=w438-h78-no" /&gt;
&lt;p class="caption"&gt;The archwiki still has a link to the old package, but it no longer exists.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="become-a-maintainer-yourself"&gt;
&lt;h2&gt;Become a maintainer yourself&lt;/h2&gt;
&lt;p&gt;Before you start to make a package, you should be familiar how to manually install other's packages from the AUR. Avoid AUR helpers for a while, trust me.&lt;/p&gt;
&lt;p&gt;Here is the quickstart guide:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://wiki.archlinux.org/index.php/Arch_User_Repository#Installing_packages"&gt;https://wiki.archlinux.org/index.php/Arch_User_Repository#Installing_packages&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;As far as the packaging process goes, it's not too difficult but I can't begin to cover it all here. Instead, I recommend reading at least all of these:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://wiki.archlinux.org/index.php/Creating_packages"&gt;https://wiki.archlinux.org/index.php/Creating_packages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://wiki.archlinux.org/index.php/Arch_package_guidelines"&gt;https://wiki.archlinux.org/index.php/Arch_package_guidelines&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://wiki.archlinux.org/index.php/AUR_submission_guidelines"&gt;https://wiki.archlinux.org/index.php/AUR_submission_guidelines&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It may also be helpful to check out my minimal &lt;cite&gt;PKGBUILD&lt;/cite&gt; here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://aur.archlinux.org/dmenu-recent-aliases-git.git
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After you cobble together what you think is a good &lt;cite&gt;PKGBUILD&lt;/cite&gt; you can ask for a review on the &lt;cite&gt;#archlinux-aur&lt;/cite&gt; IRC. Try &lt;a class="reference external" href="https://www.irccloud.com/"&gt;IRCCloud&lt;/a&gt; if you aren't familiar with IRC.&lt;/p&gt;
&lt;p&gt;Finally, submitting is as easy as a git push, but be sure all of your i's are dotted and t's are crossed.&lt;/p&gt;
&lt;p&gt;Now you are &amp;lt;strike&amp;gt;all done&amp;lt;/strike&amp;gt; just beginning. As a maintainer it's your job to keep the package up-to-date and incorporate suggestions from the community.&lt;/p&gt;
&lt;/div&gt;
</content><category term="programming"></category><category term="Linux"></category><category term="packaging"></category><category term="OpenSource"></category><category term="ArchLinux"></category></entry><entry><title>Energy harvesting wireless switch?</title><link href="http://blog.y2kbugger.com/energy-harvesting-lightswitch.html" rel="alternate"></link><published>2020-03-26T00:00:00-04:00</published><updated>2020-08-13T13:07:57-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2020-03-26:/energy-harvesting-lightswitch.html</id><summary type="html">&lt;p class="first last"&gt;Settling a bet of whether a wireless switch really didn't have a battery.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/NwiirCi5DN8tfZqP8 --&gt;
&lt;div class="section" id="robust-wireless-light-switch"&gt;
&lt;h2&gt;Robust wireless light switch&lt;/h2&gt;
&lt;p&gt;I was looking for a system of wireless switches that didn't rely on wifi. I wanted something standalone because of reliability and security. I noticed one brand advertised &amp;quot;no battery&amp;quot; and I took that at face value.&lt;/p&gt;
&lt;img alt="Amazon ad for acegoo switch" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3e3prwqvj3a56qTJPbfABldmo3IkhC8qyUA-hQMQvfjgDAdBOoHMsoCTAzI85O0CJ7_4CWY1MkytaMcMZJrZ9Um_irie8TJzTkK5IOfanQZCBFIoD6gDQctsvO9ePqWhZYthBHM4cjlzgTPprOCVqv7XQ=w683-h264-no" style="width: 100%;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="too-good-to-be-true"&gt;
&lt;h2&gt;Too good to be true&lt;/h2&gt;
&lt;p&gt;Sometime after installing I was talking to a co-worker and we started wondering: &amp;quot;Could it be a sealed lithium battery?&amp;quot; I knew this was done in the 10 year no maintenance smoke detectors, and I thought the &amp;quot;battery free&amp;quot; might actually be marketing lies.&lt;/p&gt;
&lt;img alt="How the switch is used." class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eEjxUTaaF23O8dVz19PxDf7caH6lX0eH2OfvC3i9QWno-S8bUwrJWe22icYK_95z0cyQeo_E3ASTuOUXszwaWRlbKE6G8yyNIEQl4Lg7DPehRRJbfFhZ3mC29LrRFxwPuwhqRa6uAWOL4Jy5D-ADTNlA=w545-h678-no" style="width: 60%;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="teardown"&gt;
&lt;h2&gt;Teardown&lt;/h2&gt;
&lt;p&gt;A large mechanical switch, with a smaller module in the center. There are more membrane switches than one expect for an on off switch. The antenna was run around the outside.&lt;/p&gt;
&lt;img alt="Removing the case." class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3e1pcK6VhYyIFg91zihsp8w7e9nSO3cSF1nDEVS4DLI0UFMD1PHxYkd0rWXgBNOSGo7R8NQIMLTfiMmC9PrqIpx9LVGSGF71q1Jt0iigbclF4qC-hIENJEj0azfWJJNvAXSAtw4vxTCNzfegz86OJ4pfA=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;There are levers which are moved by the switch and seem to move something back and forth internally.&lt;/p&gt;
&lt;img alt="Levers" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eam4ql5dpjHEB7kGDh28Vdq4zkvUHnVUczglv_y9HZpwTd5qKrNMH5at6RRGBqsBmi-g0KFc2hcFoKFY_rWDIKVgs6ofzoLT8gUS53uc0Q6QfeQNWk21qGmOPRCm15zUYCYCvu6UnhC_-sthopvhCpGw=w683-h329-no" style="width: 100%;" /&gt;
&lt;p&gt;Aha, magnets and a coil, it really does generate its own power!&lt;/p&gt;
&lt;img alt="Coil and magnets" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3cQPGUj_ta7hJ2nne7fHtr5S-rWLGC6o7--OqfTB7Umxolq0qH8iqd1wrLGGYLsYyJad4dTfShZOrgBVWvBhJJJ7eeqJjcgt4OZI-e8-d96kC8506VMQPcYerhZnFbLOMZ7GxOPyVgP114q5FITNwIXEQ=w532-h630-no" style="width: 100%;" /&gt;
&lt;/div&gt;
</content><category term="electronics"></category><category term="teardown"></category></entry><entry><title>Shower Speaker</title><link href="http://blog.y2kbugger.com/shower_speaker.html" rel="alternate"></link><published>2020-01-23T00:00:00-05:00</published><updated>2020-12-14T12:09:04-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2020-01-23:/shower_speaker.html</id><summary type="html">&lt;p class="first last"&gt;How I turned a light fixture into a bluetooth speaker.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/PUs3gPhkiMCq87nNA --&gt;
&lt;div class="section" id="chasing-the-dream-shower-music"&gt;
&lt;h2&gt;Chasing the dream, shower + music&lt;/h2&gt;
&lt;p&gt;I have have numerous methods for listening to music and talks in the shower. The first one was a waterproof, battery powered AM/FM radio. The reception was crap. Over the years, other solutions included bluetooth speakers of various quality.&lt;/p&gt;
&lt;img alt="light fixture pieces." src="https://lh3.googleusercontent.com/pw/ACtC-3e-UXvlfryZbjFfKdu8C9Scfgb_MKWgleQf4XdiA1egEa65oW__iavHXBEk026fI3erJyopEHpfkRPK1fhdW3Rz6RTaogGme3ZuZpQGs4nt1rTS-BL2VIYbZBS9ulICZddxjBBZ7UB6fkGMylSXYULxJA=w683-h554-no" style="width: 100%;" /&gt;
&lt;p&gt;The problem is that it is quite hard to get a speaker loud enough from outside of the shower. Before I moved I had pretty good results with a google home mini and double-sided tape. The new house though has sliding glass doors and that wouldn't work.&lt;/p&gt;
&lt;p&gt;For a while I had given up and just brought my phone in.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="take-it-up-a-notch"&gt;
&lt;h2&gt;Take it up a notch&lt;/h2&gt;
&lt;p&gt;In the new house, I started thinking about modding the light fixure for sound.&lt;/p&gt;
&lt;img alt="light fixture in place." src="https://lh3.googleusercontent.com/pw/ACtC-3e6znAbqLyEvB-bbI5jW2m10e68eZp7LuUQdQRYXmcMKSTKb_ev4HwbWqyOBNrttaRZx6xqcPWw_AjuYkEoerHotvrIN2ymGjQ0UXTeE6DROp9iNDyE-SypDFEe5aXYesS2qprYJRmKaesGlKOWsN7P3Q=w683-h303-no" style="width: 100%;" /&gt;
&lt;p&gt;After some thinking, I thought I had my options:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Google Home Mini inside the light.&lt;/li&gt;
&lt;li&gt;Round speaker to replace the light.&lt;/li&gt;
&lt;li&gt;Keep using phone.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But while I was looking for a suitable speaker I remembered something I had seen on youtube.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://www.youtube.com/watch?v=CKIye4RZ-5k"&gt;https://www.youtube.com/watch?v=CKIye4RZ-5k&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It is basically a voice-coil that can be attached to a flat surface to turn it into an active acoustic radiator. That's fancy for &amp;quot;speaker&amp;quot;.&lt;/p&gt;
&lt;img alt="Voice Coil Exciter" src="https://lh3.googleusercontent.com/pw/ACtC-3eG2MHqqrY9s8Fvr3d8dyjg3PWyTTtZj3jTuWcoD56R9TXiW0WYvyMZKN1EqII8JDodt_eV4ob_mmwqSxjyMKUBTs_Tm4YRTm9j1WpQQ5HEr9xCeWDvR8Dmj14Cdc_isX23sSqrs2lDbLvdMbDyNouDAw=w683-h379-no" style="width: 100%;" /&gt;
&lt;p&gt;I figured this would be great because it would maximize the surface area of the speaker, and it would also allow me to continue using the light fixture normally. It could also be reversibly installed.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="parts-list"&gt;
&lt;h2&gt;Parts List&lt;/h2&gt;
&lt;p&gt;Goal: Integrate using cheapest junk modules available from internet.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Voice coil - &lt;a class="reference external" href="https://www.amazon.com/gp/product/B00CWEJJ9K"&gt;$16.89&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Bluetooth Module - &lt;a class="reference external" href="https://www.amazon.com/gp/product/B07W4PJ469"&gt;$2.89/ea&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Amplifier - &lt;a class="reference external" href="https://www.amazon.com/gp/product/B01HXU1G02"&gt;$5.99&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Power Supply - Had on hand&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="interesting-bits"&gt;
&lt;h2&gt;Interesting bits&lt;/h2&gt;
&lt;div class="section" id="mixing-signals"&gt;
&lt;h3&gt;Mixing signals&lt;/h3&gt;
&lt;p&gt;Since almost all bluetooth receivers are stereo I had to mix the signals.&lt;/p&gt;
&lt;img alt="Mixer" src="https://lh3.googleusercontent.com/pw/ACtC-3fzgcIRnJm_WSAoTRZiZII9eRo6IixOsC9C7dHf8LBkvV9I0XxBWdkoA4gXzaJb2-Wg9cDVItT6miSOQRvwjTGlWyRVSGkg5jIv6j6Y4tXcSesvlGZU-bi62LuYc7__TzKHO7iLx0KbAfeR_QEjUwLPdQ=w683-h210-no" style="width: 100%;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="delay-on-for-amplifier"&gt;
&lt;h3&gt;Delay on for amplifier&lt;/h3&gt;
&lt;p&gt;I needed to design a delay circuit for the amplifier for two reasons.&lt;/p&gt;
&lt;div class="section" id="annoying-connection-chimes"&gt;
&lt;h4&gt;Annoying connection chimes&lt;/h4&gt;
&lt;p&gt;The default recording for &amp;quot;connected, on, etc&amp;quot; are annoying in general. The fact we have this tied into the light means it would have made annoying noises throughout the day, and worse, at night.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Relay for the delay circuit" src="https://lh3.googleusercontent.com/pw/ACtC-3f0f0xTF-5QaNQTsobny7fP42nz5yWxh4n8PD0Et2glHwegVbOD_mDwXXmkXL2VdbbXON_LRYF-ku1esiC9Fq_XKNvjNJvQCwEMEDnSJQ1ff3zlDJPJTPfIm3USgICtrEAEUo0xwGRzcsN_IGEFZXV5sw=w509-h678-no" style="width: 50%;" /&gt;
&lt;p class="caption"&gt;The relay controls the power amplifier as part of the delay cirbuit.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="turn-on-thump"&gt;
&lt;h4&gt;Turn-on thump&lt;/h4&gt;
&lt;p&gt;Secondly, if the amp turned on before the bluetooth, very loud &amp;quot;turn-on&amp;quot; thumps came through. I am proud of the hack for this one: I used an RC circuit to couple the delay to the status LED. The duty cycle of the &amp;quot;Connecting&amp;quot; blink would delay the amplifier indefinitely; however the solid &amp;quot;Connected&amp;quot; glow would put the amplifier on just after the crappy &amp;quot;connected&amp;quot; alert sound played.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Tuning by trial and error." src="https://lh3.googleusercontent.com/pw/ACtC-3dnWCOy3eCENtzF1VHMip7d2U9Qkxtl8Pa04Cuam66RBw0o0ihfcXctOZn57SLWRKRq95t_4_iVA2HZdr34dkigg1R47nnP9vmtzRfF3o-0FqZc_pFsE3RjYLWjUzpwUvv7OVwuqq2u-bOZneFfUt5b2Q=w683-h513-no" style="width: 100%;" /&gt;
&lt;p class="caption"&gt;Tuning the delay circuit to have an indefinite hold in the &amp;quot;Connecting&amp;quot; state.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="bad-documentation"&gt;
&lt;h3&gt;Bad documentation&lt;/h3&gt;
&lt;p&gt;Documentation for the bluetooth module was wrong and the &amp;quot;multi-purpose&amp;quot; button needed to be tied to ground to prevent phantom triggering. In hindsight this was obvious, but it was trust myself and disregard their schematic. Intermittent connection failures plagued me during almost the entire project. It was just infrequent enough to allow me to work through all the other parts of the project, but not enough to pinpoint the problem quickly.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="final-state"&gt;
&lt;h2&gt;Final State&lt;/h2&gt;
&lt;p&gt;I installed everything in a way that I could reverse everything easily in case we leave. The sound is incredibly loud, and the quality is decent. As the shower is all smooth surfaces, it can be a bit echoey. Maybe some foam/fiberglass would help, but I don't want this thing catching fire. Overall I'm extremely happy with how it turned out.&lt;/p&gt;
&lt;img alt="In place." src="https://lh3.googleusercontent.com/pw/ACtC-3fvLHQzYoWrGIsLTRfDj1ojHNkg8LIswD4eIPcDIDBS2xY3KXA7di_qyv5YifKOyI9_xw1qzfRrJWfyhIKF7hmJdqKBd1mRuPmX9828OSZjqoPsac2v36P0wqug6CQuGyh3sdf7nND3sklTSGL50cMsfQ=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;And of course it still works as a light.&lt;/p&gt;
&lt;img alt="Light on place." src="https://lh3.googleusercontent.com/pw/ACtC-3faWGrhsqaHhWAlsCEMobY7Fl6xDqtZMgx20a5Qh3ezMQjC4OZf7w3S5SV0m3QhiCYsQUJNxdMd35HdtNvuD2IrKtBM-9Qi97HZK4ADUoaHQLwFwkyzEXln3zrR0ujoo2qOo4OW4bbhZpz2y5S7Y6rRDA=w509-h678-no" style="width: 100%;" /&gt;
&lt;/div&gt;
</content><category term="electronics"></category><category term="audio"></category><category term="cheap-modules"></category></entry><entry><title>The C Programming Language</title><link href="http://blog.y2kbugger.com/the-c-programming-language.html" rel="alternate"></link><published>2019-12-31T00:00:00-05:00</published><updated>2020-07-19T22:54:03-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2019-12-31:/the-c-programming-language.html</id><summary type="html">&lt;p class="first last"&gt;Learning C from the book co-written by the one of the original language designers.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/dfXck6rcLDcZHtv17 --&gt;
&lt;div class="section" id="get-close-to-the-hardware-so-you-can-c"&gt;
&lt;h2&gt;Get close to the hardware so you can C&lt;/h2&gt;
&lt;p&gt;Since I have been learning about hardware and operating systems I wanted to learn a language which is conducive for having full control of computer hardware. C is not just good for this, the level of control C gives you was tuned for writing portable operating systems. The tooling, community, and educational resources reflect this legacy.&lt;/p&gt;
&lt;p&gt;I chose to read the Kernighan and Ritchie book because I had heard that it was not just a good book for C, but good for programming in general. There is also a historical value to learning from a primary source. I can confirm this. Working through the exercises are key to understanding why C exists.&lt;/p&gt;
&lt;p&gt;Here are my attempts at the exercises:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone git@github.com:y2kbugger/kr.git
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="the-k-r-approach"&gt;
&lt;h3&gt;The K&amp;amp;R approach&lt;/h3&gt;
&lt;p&gt;Early on they teach about structuring modules so that code and interfaces could be reused. When I previously learning C++ the reason for header files seemed to be hand waved. I appreciated the way these concepts were treated in K&amp;amp;R.&lt;/p&gt;
&lt;p&gt;Later in the book though we work through reimplement functions from the standard lib. This was insightful, especially the ones which dealt with memory management such as malloc, calloc, and free as well as the Unix system interface.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;I would definitely recommend the book to anyone interested in learning about computers. If all you care about is writing programs/computation, other languages could twist you brain in other directions (Haskell, etc), but learning C through K&amp;amp;R is a good start to learning about how computers actually work.&lt;/p&gt;
&lt;div class="section" id="but-shouldn-t-i-learn-something-modern-like-c"&gt;
&lt;h4&gt;But shouldn't I learn something modern like C++?&lt;/h4&gt;
&lt;p&gt;As a side note, don't be swayed to learn C++ merely because C is a subset. The argument goes like this: if you learn C++ you'll also learn C for free. This isn't true. If you want something a bit higher level for systems programming, I've heard good things about Rust.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="programming"></category><category term="C"></category><category term="books"></category></entry><entry><title>Persimmon English Pudding</title><link href="http://blog.y2kbugger.com/persimmon-english-pudding.html" rel="alternate"></link><published>2019-12-15T00:00:00-05:00</published><updated>2020-03-26T00:00:00-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2019-12-15:/persimmon-english-pudding.html</id><summary type="html">&lt;p class="first last"&gt;Found 6 ripe persimmons at Jungle Jim's. Took a while to decide on what to make, but I landed on making an English style holiday pudding.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/HKbDSGNgQQW1aZig8 --&gt;
&lt;div class="section" id="what-to-do-with-6-ripe-persimmons"&gt;
&lt;h2&gt;What to do with 6 ripe persimmons?&lt;/h2&gt;
&lt;p&gt;Whenever I visit &lt;a class="reference external" href="https://junglejims.com/"&gt;Jungle Jim's&lt;/a&gt;, a Cincinnati international market known as &amp;quot;a theme park of food&amp;quot;, I make sure to hunt for a new fruit. After grabbing a few interesting specimens to try, I found a section that I had never noticed before: clearance fruit. Normally overripe fruit wouldn't be too exciting, but persimmons are best when super-ripe. I took home a six pack, but I didn't have a plan for them yet.&lt;/p&gt;
&lt;img alt="Clearance persimmons from Jungle Jims." src="https://lh3.googleusercontent.com/KPn2fFh0X5Zq5ESGRaKgGDazFb6E7Rr4x5MsFJyO2akgwTP3qC_h2QCRDb6jA2uWX-2gMh7Qwqw9zrSmDSoNIPOBjisS7WHm05LkEqkDxe45oMZTsZsA1YxXmTtCIQOEuza8BTvRdpQ=w790-h508-no" /&gt;
&lt;p&gt;After a bit of googling, I settled on making an English style holiday pudding. Not being British, this was a dish I was only vaguely aware of. After reading about the dessert a bit on the internet, I had a case of what googling calls the &lt;a class="reference external" href="https://english.stackexchange.com/questions/153166/what-is-the-term-for-when-you-become-more-aware-of-something"&gt;Baader-Meinhof Phenomenon&lt;/a&gt;. It was everywhere. The strongest example was when I went to see a Christman Carol &lt;em&gt;again&lt;/em&gt;, I can't believe that the &amp;quot;pudding scene&amp;quot; had always been there, never stirring my brain to ask &amp;quot;wtf is this pudding?&amp;quot; before, I think I thought it was meat.&lt;/p&gt;
&lt;p&gt;My recipe is based on:&lt;/p&gt;
&lt;blockquote&gt;
&lt;a class="reference external" href="https://www.marthastewart.com/340210/steamed-persimmon-pudding"&gt;https://www.marthastewart.com/340210/steamed-persimmon-pudding&lt;/a&gt;&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="ingredients"&gt;
&lt;h2&gt;Ingredients&lt;/h2&gt;
&lt;div class="section" id="wet"&gt;
&lt;h3&gt;Wet&lt;/h3&gt;
&lt;blockquote class="highlights"&gt;
&lt;div class="line-block"&gt;
&lt;div class="line"&gt;1/2 c. unsalted butter&lt;/div&gt;
&lt;div class="line"&gt;2.25 c. sugar &lt;a class="footnote-reference" href="#sugar" id="footnote-reference-1"&gt;[1]&lt;/a&gt;&lt;/div&gt;
&lt;div class="line"&gt;6 very soft persimmons&lt;/div&gt;
&lt;div class="line"&gt;1.5 c. whole milk&lt;/div&gt;
&lt;div class="line"&gt;5 large eggs&lt;/div&gt;
&lt;div class="line"&gt;2 teaspoons pure vanilla extract&lt;/div&gt;
&lt;div class="line"&gt;1 lemon&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="dry"&gt;
&lt;h3&gt;Dry&lt;/h3&gt;
&lt;blockquote class="highlights"&gt;
&lt;div class="line-block"&gt;
&lt;div class="line"&gt;3 c. all-purpose flour&lt;/div&gt;
&lt;div class="line"&gt;3 teaspoons ground cinnamon&lt;/div&gt;
&lt;div class="line"&gt;1 whole freshly ground nutmeg&lt;/div&gt;
&lt;div class="line"&gt;21 allspice berries&lt;/div&gt;
&lt;div class="line"&gt;13 cloves &lt;a class="footnote-reference" href="#cloves" id="footnote-reference-2"&gt;[2]&lt;/a&gt;&lt;/div&gt;
&lt;div class="line"&gt;3 segment of a star anise &lt;a class="footnote-reference" href="#anise" id="footnote-reference-3"&gt;[3]&lt;/a&gt;&lt;/div&gt;
&lt;div class="line"&gt;1/2 teaspoon coarse salt&lt;/div&gt;
&lt;div class="line"&gt;1 1/2 teaspoons baking soda&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="simmered"&gt;
&lt;h3&gt;Simmered&lt;/h3&gt;
&lt;blockquote class="highlights"&gt;
&lt;div class="line-block"&gt;
&lt;div class="line"&gt;1/2 c. brandy&lt;/div&gt;
&lt;div class="line"&gt;1/3 c. sultanas (golden raisins)&lt;/div&gt;
&lt;div class="line"&gt;1 c. pecans, coarsely chopped&lt;/div&gt;
&lt;div class="line"&gt;1/3 c. finely chopped candied ginger&lt;/div&gt;
&lt;div class="line"&gt;4oz chopped candied citron&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="topping"&gt;
&lt;h3&gt;Topping&lt;/h3&gt;
&lt;blockquote class="highlights"&gt;
&lt;div class="line-block"&gt;
&lt;div class="line"&gt;2 c. heavy cream&lt;/div&gt;
&lt;div class="line"&gt;1/4 c. brandy&lt;/div&gt;
&lt;div class="line"&gt;2 T Powdered Sugar&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;hr class="docutils" /&gt;
&lt;table class="docutils footnote" frame="void" id="sugar" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-1"&gt;[1]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;Yes, I know sugar is not actually wet.&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="cloves" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-2"&gt;[2]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;I didn't include cloves in the mine, but I thought it would be good addition.&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="anise" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-3"&gt;[3]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;I originally only included one segment of anise.&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="directions"&gt;
&lt;h2&gt;Directions&lt;/h2&gt;
&lt;div class="section" id="step-1-prepare-the-mold"&gt;
&lt;h3&gt;Step 1 - Prepare the mold&lt;/h3&gt;
&lt;p&gt;Traditionally one would use an English pudding mold, I didn't have that so I buttered a large stainless steel mixing bowl. I used a stock pot as the boiler setting the mixing bowl on top. Add enough water to the stockpot to come halfway up the mold; to gauge depth, test this with an empty mold by pressing in into the water.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-2-prepare-the-dry-ingredients"&gt;
&lt;h3&gt;Step 2 - Prepare the dry ingredients&lt;/h3&gt;
&lt;p&gt;Sift flour, and add all &amp;quot;dry&amp;quot; ingredients to a bowl. Stir until evenly distributed.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-3-simmer-the-tasty-bits"&gt;
&lt;h3&gt;Step 3 - Simmer the tasty bits&lt;/h3&gt;
&lt;p&gt;Toast pecans in a frying pan and add all &amp;quot;Simmered&amp;quot; ingredients. Simmer for about 10 minutes.  Remove from heat; let stand for 15 minutes, allowing time for fruit to soak up excess moisture and become tender.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-4-combine-the-wet-stuff"&gt;
&lt;h3&gt;Step 4 - Combine the wet stuff&lt;/h3&gt;
&lt;p&gt;Meanwhile, slice tops off persimmons. Note: Original recipe says to press the fruit through sieve to remove skin. This is hopeless with a normal strainer and it's not hard to just separate skins by hand. Scoop out flesh, discard skins. (you should have 2 3/4 cups persimmon puree). Whisk in milk&lt;/p&gt;
&lt;p&gt;Cream butter and sugar; then add the rest of the &amp;quot;Wet&amp;quot; ingredients to the butter mixture. If you are using an electric mixer be sure to keep the bowl scraped.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-5-bring-it-all-together"&gt;
&lt;h3&gt;Step 5 - Bring it all together&lt;/h3&gt;
&lt;p&gt;Using minimal mixing, fold in all of the dry ingredients over a few quick additions. While still partially unmixed dump in &amp;quot;simmered&amp;quot; mixture of pecans, raisins, ginger, etc. Fold all until just barely mixed. Pour into prepared mold and cover with lid.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="The three mixures" src="https://lh3.googleusercontent.com/YxMdXml6K3M_39SOmbroPwndOx1unjEjvf0YwnUKmUIqFrZyqqetq5aZj2hyL6albcbDK0vNgambY9b0Wd64m5sTeKOGbXTMK3KOBW0qQ_padQUKUilE0EJ6XghTyPAIq_dXYb9vDgY=w509-h678-no" style="width: 70%;" /&gt;
&lt;p class="caption"&gt;The three mixures and the stockpot &amp;quot;double boiler&amp;quot;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="step-4-let-it-steam"&gt;
&lt;h3&gt;Step 4 - Let it steam&lt;/h3&gt;
&lt;p&gt;Bring water in stockpot to a boil. I let this go ~8 hours because of the size, 6 probably would have been ok. Since it's being steamed it can really get overcooked unless it starts to dry out. Time really depends on shape of mold+pot and the size of the pudding. Use a toothpick or skewer and test that the center is no longer a batter before calling it done.&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="Pudding after steaming." src="https://lh3.googleusercontent.com/koj8683CBoRaePybbFGA3YjxkX5-vAdsE8LhhTgkfOSyUPFZXe4sXQFc68ncTz6Cnmys3Mw-Qz-WHkc-pXfd4YzIlNo18s2Ku0rW1pWK_I7EKZIDGrrEsAflj96vFD5pmgosOpi0GTo=w509-h678-no" style="width: 50%;" /&gt;
&lt;p class="caption"&gt;Pudding after it had finished cooking.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="step-5-serve-with-cream"&gt;
&lt;h3&gt;Step 5 - Serve with cream&lt;/h3&gt;
&lt;p&gt;Now we are ready to serve.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Soft peaks of brandy whipped cream" src="https://lh3.googleusercontent.com/oQ_CT-Egd6S7kxbRT9I9L1fpvs9tpJyxXySUuVuffYpgQ_5LnLXhGPfT_Vz19Hfjuim98m-7LDfmQOzqlmUarBXNH2cKklIqFoXxUdNV3kkZpNs-leMJEQKOB1bb9pRUd0YPm-OxQ7A=w683-h437-no" style="width: 100%;" /&gt;
&lt;p class="caption"&gt;Whip the heavy cream and brandy topping to soft peaks.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure"&gt;
&lt;img alt="Pudding served" src="https://lh3.googleusercontent.com/LRNKaUfGX0sdVyRxDNYHc7Evvc7eC7owDtDOZInKmo7vDY5uBatRz7UdQK8qV16hkfWbTy1oZQ7EUM2RITLwqc_6O-Dt8FJooX7xyxKQzZxfgp6Fm1jn2JFtG3lBKb0uHsRN_nJES9g=w509-h678-no" style="width: 100%;" /&gt;
&lt;p class="caption"&gt;Flip the pudding out onto a plate and cut. Serve with brandy cream sauce.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="food"></category><category term="dessert"></category></entry><entry><title>Chicken Paprikás</title><link href="http://blog.y2kbugger.com/chicken-paprikas.html" rel="alternate"></link><published>2019-10-09T18:28:00-04:00</published><updated>2020-08-17T19:21:36-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2019-10-09:/chicken-paprikas.html</id><summary type="html">&lt;p class="first last"&gt;My take on Hungarian chicken paprikás from scratch.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album Misc: https://photos.app.goo.gl/dfXck6rcLDcZHtv17
Google Photos Album I: https://photos.app.goo.gl/4jcGDYtw2jQDj5QM7
Google Photos Album II: https://photos.app.goo.gl/tk89uXTZvQuDoXk7A --&gt;
&lt;div class="section" id="chicken-paprikas-a-family-favorite"&gt;
&lt;h2&gt;Chicken paprikás, a family favorite.&lt;/h2&gt;
&lt;p&gt;One of my favorite meals growing up was my Grandma Jean's chicken paprikás. She made it at least several times a year for us while I was growing up. Recently my wife Sara and I have been going to her house once a week to visit and make her dinner. This week it was our turn to make this dish for her.&lt;/p&gt;
&lt;img alt="Finished Paprikás" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eYOIF2b1hhDRxDx3L4re8JzhX-c5MLR3D3O84bvOhUs1g_F4-5oGNYAEAalR3KrRocmKsmCrvbF9U0QViCwxEtE7LZZuStd2e5rz8nkzSTKJxGhNH3iu979YY1xgNRlmzAReKvd_ErvSwgWC9QQPppew=w683-h284-no" style="width: 100%;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="the-prep"&gt;
&lt;h2&gt;The Prep&lt;/h2&gt;
&lt;p&gt;The stock, dumplings, and chicken brine, were completed the day before visiting Grandma.&lt;/p&gt;
&lt;div class="section" id="chicken-stock"&gt;
&lt;h3&gt;Chicken Stock&lt;/h3&gt;
&lt;p&gt;This recipe is from scratch, including the stock.&lt;/p&gt;
&lt;img alt="Vegetals as part of the stock base." class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3ezMSIz0mrXeS7pKSqJvqslc3hrLarGEnHOtqtSO3zgY1H7kz-qEKP9FmOZTs4zn4bgbOYgm2W1st18Vo3Jqqu0bKCV-KcqyIRXhw_B74O2ZUlhghy1OprPEHP1WQz4udqfFiHjeL0M8giMzkHMjcGsXQ=w509-h678-no" style="width: 100%;" /&gt;
&lt;p&gt;After breaking down the chicken into skin-on legs, wings and breasts, I browned the chicken scraps by roasting them in the oven before adding them to simmer in the stockpot.&lt;/p&gt;
&lt;img alt="XXXXXXXXX" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3fLHCX556ZB7Cr6LnPCrzHeS785nn_Q7T_NsDR59bUevbi4GtgccbQfMsxoj-3gjJcgJmEB1zCyLRlFwOosciCd2cmv8LztAiXuNqKHhsb6fB57hv69VvwU4XJtDETvazDH-X9oAn78zIffed-SHrB6eQ=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Liquid chicken gold.&lt;/p&gt;
&lt;img alt="XXXXXXXXX" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3fLekXN0bruwntFsCaG3G-A65iCpB5FG6Z4SvD0TFZFiN-Eh98uTHXpzKRZJZ0LFuMiJD88vOrqFjXZzR3V5KltXDQ_0GdIRi02Hw5C5Oqjz9pwsbCru8i_4ZL8u2o3278wwymvY_wJHdqR9GB0hrlcuw=w509-h678-no" style="width: 100%;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="brining-the-chicken-pieces"&gt;
&lt;h3&gt;Brining the chicken pieces&lt;/h3&gt;
&lt;p&gt;One key to extra moist and flavorful chicken is a 6 hour brine.&lt;/p&gt;
&lt;img alt="XXXXXXXXX" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3fILdbGA-kThHo4xGFgwT9xKnz9v2UJyS2rktRxM1X836UIN_xq_UHLNVLwpxm9zO4pwoFDuNYo4CU20JwJbc87BgTr_5iKmfC_RW5YbTpHgW5cAq3l8oQ37L8mxw_Zg0SknRWzzFlARAOWHnQsDtJStA=w683-h513-no" style="width: 100%;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="the-dumplings"&gt;
&lt;h3&gt;The dumplings&lt;/h3&gt;
&lt;p&gt;Because they are time-consuming, I also made the dumplings the day before.&lt;/p&gt;
&lt;img alt="The wet and dry of the dumplings" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3f4LDWeShY3fEcshKv89xY-6nZpF3tJUsXmRmlYXrzYyzEpVrK4YdIrDrbTshkjCm3uHlXfpsPNf7BjP3n_8v-U8Stgmr4TlVK3LWmiKNjIa0HTqMGotCOYDiM50I4gL16lI1dkbbIWqCnchtZCRp5REA=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Use the &amp;quot;well&amp;quot; technique.&lt;/p&gt;
&lt;img alt="How to start the dumplings" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eA6haMJ4cmGMLzC1FBaw-UHuql5T80bN2nEVG37DIsmXAJ_wdDFohzu2Sr1M1sK30_GegByUtiPy0Xv3wHmPQM0oTHJ8txs7DUpXvDjD3z9nxFXecZvENMZ-t9xg85AnKo6tEKqAsfpnKw4PZaJqZo4A=w576-h678-no" style="width: 100%;" /&gt;
&lt;p&gt;We have always made them larger than german spaetzle, and slightly larger than tradition Nokedli.&lt;/p&gt;
&lt;img alt="Forming the dumplings" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3e-ybKcJcb4ZRRw5_qQ7M2fUnrgHnQd54imbs8ltQsXF_wR0Pk-KXYsEAml73dtLS6JjN_Upop5D06ScBJ3zzdfQ6VizWdwvx2l6n_spg9IOZ2HtXJueAxGccwmvApv7IdtJs8gYBPbkeHVt9AQkbq9_g=w496-h628-no" style="width: 100%;" /&gt;
&lt;img alt="Bowl of dumplings" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3dfNnhWKH9nki9wz3sHvA98Xn7wrL22Kj78r1mfZhRf30B3h0BQJVXiG6cr5ZjVfs_y_9kkON3UI_5zvqRgr0yw-NXO4dMwCAbRJDDMxzEc8GoeDY6f7XSypNGJQ8jLiJAuMiatAa8cV12cNuCLl7Q85w=w509-h678-no" style="width: 100%;" /&gt;
&lt;img alt="Sara with the finished goods." class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3fZK6YNoNcpEmN7RaFfsZkQYcLw08RtXm8II82bZkqI5Z3LE5Ihxq6rkzReQL_div9L5u5Ou0K6OKYxZK3ZVQYa3RGKApRJjLVvGJF2_J4ESqX55kjOWi7BoqHmea2RfrGLgxQlMmViFzCkAVlS4UUlTQ=w509-h678-no" style="width: 100%;" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="bringing-it-all-together"&gt;
&lt;h2&gt;Bringing it all together&lt;/h2&gt;
&lt;p&gt;On the day of the dinner we fried and simmered the chicken and prepared the most important part, the sauce.&lt;/p&gt;
&lt;img alt="XXXXXXXXX" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eYPz5Dk1ztz5FNeGMHwN0bkav4ODWATrzdsCxaWsbemTDKPRn1fJowQSEBEcxjD3doFeMmy5hGXmOn5xmLNp35Vi79eV6Xnp3Oz-Vr2H7wVilXAApWqLM1ZO7rMTY4aybyIc65QX-MUoiNFo8PaPmWfQ=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Render a whole pound of bacon fat, keep the crispy bacon for a topping.&lt;/p&gt;
&lt;img alt="Rendering the fat out of the bacon." class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3do-OoOnY11oTIQOyIEJi0_6XmSA8iBUyqx86FQS6Z7YAseKET6VE4EPS-aPcRvAacRVmgGq1WgHiY5zFwQNF9qqw5C4lBTnzAKxkGBJbCJcxCNl3KQsHP3vWgz89HTZza0R0G3vzaUGOkvgTk0lGCnRQ=w683-h207-no" style="width: 100%;" /&gt;
&lt;p&gt;Bread the chicken with a mixture of flour, paprika, and salt to taste.&lt;/p&gt;
&lt;img alt="Bread the chicken" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3dBSTyCcaoPBbGvqZfdTS17hmd_iw0dgjrNBQC313IBByMV33FyOmGTfAOvqfZE8Snp6011WZMAlER_9_rtbwlIec2h4-isiDXQWol2g0QivdcIQh7koriokenErmyIdOOyw9sY9dhclhTdHtULb9SckQ=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Brown the chicken to add flavor, no need to cook thoroughly.&lt;/p&gt;
&lt;img alt="Brown the chicken" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eBUMqMQxL-JqRQoD37546mMaCbuYJettHMXmny11-0vevrnE3TeRAyBJR6Z-5xQvdLJHTS_jLC0kiQv6TDjQldCT30SfRul-a2oX5vnNNjtC6k_DKzxYfJMPw5EbsyivH-whlKXsysT0TnMUcaxw33Zg=w683-h513-no" style="width: 100%;" /&gt;
&lt;img alt="Fry the chicken in the bacon grease" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3dWiHUKAU_5ycPhrSYtirXqpimrVShLMqR7-5rxXJveOtUE_z74tFKJw0lJSg-o5U8GF1TPvakeyXcibbay_BuF5uAiO380-s70Hq_1ILdyqF27PANmF34Sih1LSmBSqP4_CcQxkuM8MFr7S-gFX0L1Pg=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Now simmer the onions in the remaining grease just until translucent.&lt;/p&gt;
&lt;img alt="Onions simmering" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eh_YXjy5JUNkZYRLobin11IUgtXy88Uzfw7l1_-mV2ZzTTt7eOunFC7hMTfMoTP0kghnoyQ-VpRxCqu0ZBDtg7eCAXvRDdpzLSYesdyUKAdBrs9zSZgyXgzyb5fCm1Le3L8wdmuVwKeWDUQ_Pe9KKVRw=w269-h400-no" style="width: 40%;" /&gt;
&lt;img alt="then soften the onions in the remaining bacon grease" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3fDPVdn6tcsNr3T1W8N0x2iYM6DN48oXUpgvKbRKhDG8sGIe-eza3_MOkcA1pN4gZzx-ZwApbccCrEp7xGL2YnY4x1NW88-r9Hv-K7BwJDC5IXC7SaG5wQpF7vpVhrP_R9uJ4-JGvfD2a-AanqNDZ0Ajg=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Layer the onions in with the chicken.&lt;/p&gt;
&lt;img alt="Layer in chicken with onions." class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3eIDKYebE4ZrTBLXzOqcxZPUrQLzrqhUtao_0VysupX0_nSJ3TKYN9t5B6heWK2Ui527Ginibjw6paxMAKr_gsI_PXpiaVUEOBUKvpSyv-bkOmHRs3agmn2kM77aS-S9JogjMNuNeP6Uv99C1SCWgQf4A=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Now add with chicken stock concentrate.&lt;/p&gt;
&lt;img alt="Add the chicken stock" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3e9iPwv9k_CN6uHBsp4dvtARdxxeepwbS-5C3qXjgYjMeXajBin23qv0hJ3Wb3eKZz1mK-0FwCp5k_PjZFCyO8Mm2xP_LhjMS-1LhFRody6wZSMF8l_HFA7FCJN0DrpBOsdHew7WsI8P6aPexJscXWq3A=w509-h678-no" style="width: 100%;" /&gt;
&lt;p&gt;Simmer long enough to finish cooking the chicken and completely disintegrate the onions.&lt;/p&gt;
&lt;img alt="bubbling away" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3cnNdZyr080dQuXGSRhUJVPcfWbWRPmwoMAcR8Yesp2ZKBfC4ZrHkfZ7-RJCWY3GsSYDd3YEG9Ij6fFUCpolWJ0xClGbxR3TzFo-2DJNTkumGEYm1CLS63CjyUpOANDls_U3Kp7cI1HA2z4ii5K7ILSFQ=w600-h368-no?authuser=0" style="width: 100%;" /&gt;
&lt;p&gt;The finished product. To finish the sauce, add paprika and sour cream to taste. You can also thicken with flour if needed.&lt;/p&gt;
&lt;img alt="The finished product" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3cnhcnQdHKcOkrHMJbBDv4adeEgYBwEJQYY97TV_o3GHBSgAERth4p65Mz4o_3xx4ocmXUhtJ-lBvuJOEmflDc7z8SZkMNBLGrQidTNS7vvk1gBJwYXWvc8QRPjBQsP8hIL-KrXSubmqoLq8OlYFl20MQ=w683-h284-no" style="width: 100%;" /&gt;
&lt;p&gt;We all enjoyed it.&lt;/p&gt;
&lt;img alt="We all enjoyed it." class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3dMa8Kytm_pCS_30asz19F7yeWIhNRmEjj-Q1O89zLPmZzDpxMMaUy4jUEoKSTcM9HQL6hw4kLAGf4VxxzRXqq26H4hNwBOthK3PwmY1Hq1D6OUVFYOQgEz_Al4GSHl4NxHorfr0xprfo7mlScdXH2I1A=w509-h678-no" style="width: 100%;" /&gt;
&lt;/div&gt;
</content><category term="food"></category><category term="dinners"></category></entry><entry><title>MMIX WASM</title><link href="http://blog.y2kbugger.com/mmix-wasm.html" rel="alternate"></link><published>2019-09-28T02:14:30-04:00</published><updated>2020-09-01T02:32:27-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2019-09-28:/mmix-wasm.html</id><summary type="html">&lt;p class="first last"&gt;Compiling the MMIX Assembler and Simulator to Web Assembly&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/dfXck6rcLDcZHtv17 --&gt;
&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#fast-feedback-for-the-art-of-computer-programming-exercises" id="toc-entry-1"&gt;Fast feedback for The Art of Computer Programming Exercises&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#dependencies" id="toc-entry-2"&gt;Dependencies&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#mmixlib" id="toc-entry-3"&gt;MMIXlib&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#emscripten" id="toc-entry-4"&gt;Emscripten&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#approach" id="toc-entry-5"&gt;Approach&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#demo" id="toc-entry-6"&gt;Demo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="fast-feedback-for-the-art-of-computer-programming-exercises"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-1"&gt;Fast feedback for The Art of Computer Programming Exercises&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As I started working through the &lt;a class="reference external" href="https://blog.y2kbugger.com/reading-taocp-mmix.html"&gt;exercises in TAOCP&lt;/a&gt;, I wanted a quicker way to work on the problems in the MMIX assembly language. I was also in the process of learning C so I was interested in trying to understand the code behind MMIXware, the simulators for the MMIX computer.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="dependencies"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-2"&gt;Dependencies&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="mmixlib"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-3"&gt;MMIXlib&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;MMIXware is made up of multiple programs, including an assembler and a simulator. Details can be found at the homepage here: &lt;a class="reference external" href="http://mmix.cs.hm.edu"&gt;http://mmix.cs.hm.edu&lt;/a&gt;. When browsing the SVN trunk I noticed a project called MMIXlib. This is a refactoring effort by Martin Ruckert to partition the original MMIX tools into something he could integrate into an IDE. I decided to use this as the base for how I would plug into the MMIX assembler and simulator.&lt;/p&gt;
&lt;p&gt;One thing that is surprising if you haven't seen it before is MMIXware being written in CWEB, This is a literate programming system developed by Donald Knuth. The CWEB files compile to C, but I needed to install all of texlive to do so. There is a rule that you are not to change the original source code but only apply CWEB style &amp;quot;change files&amp;quot;. This allows the entire refactoring to actually be a layer of explained changes applied to the original MMIXware.&lt;/p&gt;
&lt;p&gt;When I was working through the compilation process, I found a couple of errors in MMIXlib, and also I suggested a small enhancement to the Makefile. As is tradition with Donald Knuth's projects, there was a reward for finding errors in MMIXware. Even though I think my contribution was small I'm proud to have gotten a MMIX shirt for the contribution.&lt;/p&gt;
&lt;img alt="mmix shirt" src="https://lh3.googleusercontent.com/pw/ACtC-3cFCw5pcP4PjQ42htLHTNWtHNCmNJq4lxvQjEMtxlMtKjBK_P6DHh2c05aIIGVsdb5RBNnMFY7dOzUsMa8EECwxEvNJY8tTF4hpSk00R7sk52YwUXK55kyJkIC9epT5yxHK_k8DqhKY6qrrMXL1YOaC3Q=w742-h989-no" /&gt;
&lt;/div&gt;
&lt;div class="section" id="emscripten"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#toc-entry-4"&gt;Emscripten&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I decided to compile to MMIXware to web assembly for two reasons:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;I wanted to see what it took to compile some legacy C program to WASM&lt;/li&gt;
&lt;li&gt;The web is flexible for UIs, I could make it as polished as I wanted&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="approach"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-5"&gt;Approach&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;MMIXlib allows you to hook into various parts of the simulator and emscripten allows exposing C functions directly to JavaScript. This allows the main loop to run in js, with all of the hard work being done on the WASM side. Emscripten also has the ability to fake out a file system and expose that to JavaScript as well. This allowed me to be extra lazy and not even have to modify the IO of MMIXware.&lt;/p&gt;
&lt;p&gt;The hardest part was deciphering compile errors/warnings that manifested from compiling old C code with a modern compiler while also tracing through CWEB source and change files.&lt;/p&gt;
&lt;p&gt;The part that I can take the most credit for is adding the register watcher. This involved work on both the js side and the C code. I hope to add the ability for watching multiple registers. Other inner workings I would like to expose are special registers and memory ranges.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="demo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#toc-entry-6"&gt;Demo&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As you modify the input, the simulator will reassemble and restart. Choose a general register to watch, 0-255. You can also change the frequency we run the simulator at.&lt;/p&gt;
&lt;p&gt;More programming examples can be found in the MMIX repository &lt;a class="reference external" href="https://gitlab.lrz.de/mmix/mmixware"&gt;https://gitlab.lrz.de/mmix/mmixware&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone git@github.com:y2kbugger/mmix-wasm.git
&lt;/pre&gt;&lt;/div&gt;
&lt;iframe frameborder="0" width="100%" height="1400px"  src="https://d1aby3vgncc46a.cloudfront.net/mmix-wasm.html"&gt;&lt;/iframe&gt;&lt;/div&gt;
</content><category term="programming"></category><category term="assembly"></category><category term="algorithms"></category><category term="MMIX"></category><category term="TAOCP"></category><category term="books"></category></entry><entry><title>Learn How Computers Work Between Silicon and Assembly: Build a CPU with Python</title><link href="http://blog.y2kbugger.com/2019-07-28-pyohio.html" rel="alternate"></link><published>2019-07-28T00:00:00-04:00</published><updated>2021-12-04T16:02:25-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2019-07-28:/2019-07-28-pyohio.html</id><summary type="html">&lt;p class="first last"&gt;PyOhio 2019, Columbus, Ohio&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;PyOhio&lt;/strong&gt;, &lt;em&gt;Columbus, Ohio&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://drive.google.com/open?id=1u8qlAK4SeqFX3ybT7zVuKWItMvCadhsgF9WmCCOM3dQ"&gt;Slides&lt;/a&gt; &lt;a class="reference external" href="https://mybinder.org/v2/gh/y2kbugger/sapy.git/mybinder-release?filepath=Simple%20As%20Possible.ipynb"&gt;Live Jupyter Notebook&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://y2kbugger@github.com/y2kbugger/sapy.git
&lt;/pre&gt;&lt;/div&gt;
&lt;!-- git clone - -branch 2019-07-28-PyOhio https://y2kbugger@github.com/y2kbugger/sapy.git --&gt;
&lt;div class="videoembed-container"&gt;
&lt;iframe class="videoembed-iframe" src="https://www.youtube.com/embed/iJqCMoAMlMA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Programming languages are designed for a specific level of abstraction or distance from the hardware. The main trade off is &amp;quot;developer productivity&amp;quot; vs. &amp;quot;control over hardware&amp;quot;. C and assembly are low level and therefore map closely to CPU instructions. Python on the other hand goes through many layers, libraries, and a virtual machine before the CPU is reached. This allows powerful programs to be written concisely and cross-platform—but it also conceals the true nature at the heart of our modern world. Unveiling the magic within can lead to interesting insights about how computing got to where it is today.&lt;/p&gt;
&lt;p&gt;We will build up CPU focused on transparency, interactivity, and modularity. Our CPU has a configurable architecture and machine language. Yes, you can invent your own assembly instructors to add functionality. We will cover registers, data/address busses, memory (ROM/RAM), IO, and assemblers.&lt;/p&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="PyOhio"></category><category term="Python"></category><category term="Retrocomputing"></category><category term="CPUs"></category></entry><entry><title>MMIX - Working on TAOCP in RISC</title><link href="http://blog.y2kbugger.com/reading-taocp-mmix.html" rel="alternate"></link><published>2018-12-27T00:00:00-05:00</published><updated>2020-05-29T15:18:21-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2018-12-27:/reading-taocp-mmix.html</id><summary type="html">&lt;p class="first last"&gt;How to read The Art of Computer Programming and do the exercises in modern RISC rather than a 1960s style architecture.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/dfXck6rcLDcZHtv17 --&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;This article I will cover why I want to read TAOCP as well as my approach. Because the books are in various states of publication, one must use additional resources besides the book to enjoy the updated RISC material.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-art-of-computer-programming"&gt;
&lt;h2&gt;The Art Of Computer Programming&lt;/h2&gt;
&lt;p&gt;The Art of Computer Programming is a legendary multi-volume computer science textbook. It was originally conceived in 1962 as a 12 chapter book documenting a wide range of algorithms. The rapid pace of change in computer science made these chapters a moving target; while Volume 1 was released in 1968, Volume 4 is still in progress as of 2020 &lt;a class="footnote-reference" href="#taocpwiki" id="footnote-reference-1"&gt;[1]&lt;/a&gt;.&lt;/p&gt;
&lt;img alt="The Art of Computer Programming" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3fz2RxP2aYWm20KIl9hU_BkQcyTNxSmewF-0TM7KLe2BbVwUsml4DmX7kgHf4E8vARaOSQFJ-d1zou3FMoD4hjaX8q3jSFcKZwty559C8BiomechHmEW7gwmIBd8kJvi0u4Zqx0I6UDlA65QuBUX_CEdQ=w500-h431-no" style="width: 33%;" /&gt;
&lt;p&gt;The book is notable for being comprehensive and precise as well as for the extreme care given to the exercises and solutions. Because it's known for being a huge undertaking, some people quip that the book is often recommended without actually having been read. I suspect this is because the algorithms are explained using assembly language rather than structured programming which some people deem as impenetrably  obscure.&lt;/p&gt;
&lt;div class="section" id="why-i-want-to-read-it"&gt;
&lt;h3&gt;Why I want to read it&lt;/h3&gt;
&lt;p&gt;I believe it when Knuth says that you learn something extra about algorithms at the interface of hardware and software. In C for example you may not know what is happening in hardware when you write an if statement, but in assembly this is in-your-face.&lt;/p&gt;
&lt;p&gt;He puts it like this:&lt;/p&gt;
&lt;blockquote&gt;
One of the principal goals of my books is to show how high-level constructions are actually implemented in machines, not simply to show how they are applied. &lt;a class="footnote-reference" href="#knuthmmix" id="footnote-reference-2"&gt;[3]&lt;/a&gt;&lt;/blockquote&gt;
&lt;p&gt;This aligns with my goal of exploring computers to the lowest levels including operating systems as well as CPUs. The more I can understand the software-hardware interface, the happier I will be. Learning algorithms via TAOCP is the software side of my strategy. On the hardware side I'm exploring TTL logic, CPU design, and simple cases of systems integration using vintage microprocessors such as z80, 6502 and 1802. This has also led me to explore prototyping via FPGAs and one day I hope to design a CPU core and bootstrap up to a self-hosting multitasking development environment.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="mix"&gt;
&lt;h2&gt;MIX&lt;/h2&gt;
&lt;p&gt;In order to facilitate the teaching of algorithms and how they interact with hardware, Knuth developed a CPU architecture and corresponding assembly language.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;MIX is a hypothetical computer used in Donald Knuth's monograph, The Art of
Computer Programming (TAOCP). MIX's model number is 1009, which was derived
by combining the model numbers and names of several contemporaneous,
commercial machines deemed significant by the author. Also, &amp;quot;MIX&amp;quot; read as a
Roman numeral is 1009.&lt;/p&gt;
&lt;p class="attribution"&gt;&amp;mdash;Wikipedia &lt;a class="footnote-reference" href="#mixwiki" id="footnote-reference-3"&gt;[2]&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Knuth states that &amp;quot;MIX is very much like nearly every computer of the 1960s and 1970s except that it is, perhaps, nicer.&amp;quot;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="mmix"&gt;
&lt;h2&gt;MMIX&lt;/h2&gt;
&lt;img alt="MMIX" src="https://lh3.googleusercontent.com/pw/ACtC-3cmwaXo3THz54nq3bz9bWJ9N3hK5zfHL9o4JAsdri5mZ7AgP4LPpilaSkxatNxccRDbxKgZ65jDB08Akq1UMV1nGGqktUrq8uXJFhs9ODgtUQ1wT6SAapWlK5zTWLP-tliFKDBuARvEVYmHnRilf89CsQ=w572-h85-no" /&gt;
&lt;p&gt;Computer have changed significantly since the 60s, as Knuth explains:&lt;/p&gt;
&lt;blockquote&gt;
Thirty years have passed since the MIX computer was designed, and computer architecture has been converging during those years towards a rather different style of machine &lt;a class="footnote-reference" href="#knuthmmix" id="footnote-reference-4"&gt;[3]&lt;/a&gt;.&lt;/blockquote&gt;
&lt;img alt="Under Construction" src="https://lh3.googleusercontent.com/pw/ACtC-3fRUt39VqJiEOQ9LhFcwVrsuth55pRA44lyfN51vxoNG0v0DshXSPqc5SdCtLdAnCWPOfLaP-KS5iDdApF0YKfAM8SBZmgyI61tLobpe8lVmxjGyNFkdrOpxaOD4cpvrJddWkV7lvJAUvmMONAoJF6dtg=w683-h131-no" /&gt;
&lt;p&gt;In Volume 1 3rd Edition, he states his plans to replace MIX:&lt;/p&gt;
&lt;blockquote&gt;
However, it must be admitted that MIX is now quite obsolete. Therefore MIX will be replaced in subsequent editions of this book by a new machine called MMIX, the 2009. MMIX will be a so-called reduced instruction set computer (RISC). [...] It will be even nicer than MIX and will be similar to machines that have become dominant during the 1990s.&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="subsequent-editions-fascicles"&gt;
&lt;h2&gt;Subsequent editions, fascicles&lt;/h2&gt;
&lt;p&gt;So we've chosen to explore MMIX, the forward looking ISA of TAOCP, now what? The dilemma we face is that the next edition has not been released yet. The most recent edition, V1 3e, has all of the questions and answers still written with MIX.&lt;/p&gt;
&lt;img alt="The three required books for MMIX" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3cuRVuJCUSUugDBBPjEjvV-g4h9rh4NuHipmWhjvJbgS3zKZGBYrkea6kFi6MYL6-gC-mmhqHvCIB6FMcG6fHf_wzLQ3FSggliRMHXReoaJXcB4XEkEYYUFVJ-tzUwnb0Htv9v26hcMSSMf6vrfC46HXQ=w683-h459-no" /&gt;
&lt;p&gt;So what choice do we have then? Well Donald has kindly release what is known as V1F1 or &lt;em&gt;The Art of Computer Programming, Volume 1, Fasicle 1 -- A RISC Computer for the New Millennium&lt;/em&gt;. A fascicle is a &amp;quot;a separately published installment of a book or other printed work.&amp;quot; Basically it acts as a patch for V1 3e. Replacing the chapter explaining MIX with the MMIX equivalent. It is available on &lt;a class="reference external" href="https://https://www.amazon.com/Art-Computer-Programming-Fascicle-Millennium/dp/0201853922/"&gt;Amazon&lt;/a&gt;. Fun note, these are printed on demand when you place your order.&lt;/p&gt;
&lt;div class="figure align-right"&gt;
&lt;img alt="On demand printing" src="https://lh3.googleusercontent.com/pw/ACtC-3dsG1EowkXAZFHTN5U6GoiV7aHLiLZj4qS4T-LL4_G7bSkTLQFbru0xIrfOSHiVYxg3UDcSqjI3_DC0HQvAiMNwwaaUBNkcFkEqL0Zx5m11fvY5ctohhCmg8e60Y_SAX8k1jyvou9g_R2JqBcRycjhmbg=w509-h678-no" style="width: 66%;" /&gt;
&lt;p class="caption"&gt;Printed the day after I ordered on Amazon.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;That covers the basics of the language, but all of the solutions also needed reworked. Knuth put out a request for people to collaborate on the solutions, a project he called MMIXMasters &lt;a class="footnote-reference" href="#mmixmasters" id="footnote-reference-5"&gt;[4]&lt;/a&gt;. The end result of this is known as the MMIX supplement. It's available on the web, &lt;a class="reference external" href="http://mmix.cs.hm.edu/supplement/index.html"&gt;http://mmix.cs.hm.edu/supplement/index.html&lt;/a&gt; as well as in printed form on Amazon: &lt;a class="reference external" href="https://www.amazon.com/MMIX-Supplement-Computer-Programming-Volumes/dp/0133992314"&gt;MMIX Supplement&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="future-work"&gt;
&lt;h2&gt;Future Work&lt;/h2&gt;
&lt;p&gt;I'm excited to keep working through these exercises. To assist the process of testing various algorithms, I've started a side-project which I have compiled Knuth's original MMIX toolchain to WASM and wrapped it in a simple IDE for MMIX in the browser.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="hardware-and-risc-v"&gt;
&lt;h2&gt;Hardware and RISC-V&lt;/h2&gt;
&lt;p&gt;I plan to continue working on the hardware side in tandem as well. I dream of the day I could write some of these algorithms for an FPGA RISC-V CPU or even more exciting, a toy ISA of my own.&lt;/p&gt;
&lt;table class="docutils footnote" frame="void" id="taocpwiki" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-1"&gt;[1]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/The_Art_of_Computer_Programming"&gt;https://en.wikipedia.org/wiki/The_Art_of_Computer_Programming&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="mixwiki" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-3"&gt;[2]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/MIX"&gt;https://en.wikipedia.org/wiki/MIX&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="knuthmmix" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;[3]&lt;/td&gt;&lt;td&gt;&lt;em&gt;(&lt;a class="fn-backref" href="#footnote-reference-2"&gt;1&lt;/a&gt;, &lt;a class="fn-backref" href="#footnote-reference-4"&gt;2&lt;/a&gt;)&lt;/em&gt; &lt;a class="reference external" href="https://www-cs-faculty.stanford.edu/~knuth/mmix.html"&gt;https://www-cs-faculty.stanford.edu/~knuth/mmix.html&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="mmixmasters" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#footnote-reference-5"&gt;[4]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a class="reference external" href="http://mmix.cs.hm.edu/mmixmasters/index.html"&gt;http://mmix.cs.hm.edu/mmixmasters/index.html&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</content><category term="programming"></category><category term="assembly"></category><category term="algorithms"></category><category term="MMIX"></category><category term="TAOCP"></category><category term="books"></category></entry><entry><title>Learn how computers work between silicon and assembly — Build a CPU with Python</title><link href="http://blog.y2kbugger.com/2018-12-11-carpe.html" rel="alternate"></link><published>2018-12-11T00:00:00-05:00</published><updated>2021-12-04T16:02:25-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2018-12-11:/2018-12-11-carpe.html</id><summary type="html">&lt;p class="first last"&gt;CARPE December Meeting, Columbus, Ohio&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;CARPE December Meeting&lt;/strong&gt;, &lt;em&gt;Columbus, Ohio&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://drive.google.com/open?id=12KYvWFvr7uSeOLgl2vSXf_TAWIMcBV3WC4VD1vP2Oag"&gt;Slides&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone --branch 2018-12-11-CARPE https://y2kbugger@github.com/y2kbugger/sapy.git
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Slide about my CPU presentation." class="align-center" src="https://lh3.googleusercontent.com/ZXuaqX-m6ynsOKnvGmfCwM3ov2loiSR3v2blG5vykRSaExcyKPn1WL-BS2tEj5kS_Dp0PojmRHXiyDcioR6WHKNAOWr_P_hSRZ0Vj98yR8fn-mBovfziqiXAZj5poI7Wl_O98YkYQIQ=w596-h447-no" style="width: 100%;" /&gt;
&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Programming languages are designed for a specific level of abstraction or distance from the hardware. The main trade off is &amp;quot;developer productivity&amp;quot; vs &amp;quot;control over hardware&amp;quot;. C and assembly are low level and therefore map closely to CPU instructions. Python on the other hand goes through many layers, libraries, and a virtual machine before the CPU is reached. This allows powerful programs to be written concisely and cross-platform—but it also conceals the true nature at the heart of our modern world. Unveiling the magic within can lead to interesting insights about how computing got to where it is today.&lt;/p&gt;
&lt;p&gt;We will build up CPU focused on transparency, interactivity, and modularity. Our CPU has a configurable architecture and machine language. Yes, you can invent your own assembly instructors to add functionality. We will cover registers, data/address busses, memory&amp;nbsp;(ROM/RAM), IO, and assemblers.&lt;/p&gt;
&lt;p&gt;Specs for nerds: 8-bit words, 256 memory addresses, Von Neumann w/ shared address+data bus, DMA with numpy based buffer.&lt;/p&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="CARPE"></category><category term="Python"></category><category term="Retrocomputing"></category></entry><entry><title>Learn how computers work from opcodes to IO — Building a Virtual Machine in Python</title><link href="http://blog.y2kbugger.com/2018-10-29-cohpy.html" rel="alternate"></link><published>2018-10-29T00:00:00-04:00</published><updated>2021-12-04T16:02:25-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2018-10-29:/2018-10-29-cohpy.html</id><summary type="html">&lt;p class="first last"&gt;COhPy October Meeting, Columbus, Ohio&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;COhPy October Meeting&lt;/strong&gt;, &lt;em&gt;Columbus, Ohio&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://drive.google.com/open?id=1Laue0CnRrtKDYxWJLnYe6d2f8ZJHxvSshZZY9GZTpEI"&gt;Slides&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone --branch 2018-10-29-COhPy https://y2kbugger@github.com/y2kbugger/sapy.git
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;Programming languages are designed for a specific level of abstraction or distance from the hardware. The main trade off is &amp;quot;developer productivity&amp;quot; vs &amp;quot;control over hardware&amp;quot;. C and assembly are low level and therefore map closely to CPU instructions. Python on the other hand goes through many layers, libraries, and a virtual machine before the CPU is reached. This allows powerful programs to be written concisely and cross-platform—but it also leaves an immense &amp;quot;Magic Valley&amp;quot; of faith. Eliminating the magic can lead to interesting insights and a greater appreciation for the subtleties of performance, quirks of legacy compatibility, and the purpose of operating systems.&lt;/p&gt;
&lt;p&gt;We will build up a virtual machine in Python, and I will connect these concepts to concrete hardware details as they naturally emerge. Guaranteed material: opcodes, CPU, data/address bus, ROM/RAM, and IO. Bonus material: assemblers, interrupts, tty output.&lt;/p&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="COhPy"></category><category term="Python"></category><category term="Retrocomputing"></category></entry><entry><title>The Art of (Virtual) Rubber Compounding</title><link href="http://blog.y2kbugger.com/2018-09-12-tire-society.html" rel="alternate"></link><published>2018-09-12T00:00:00-04:00</published><updated>2021-12-04T16:02:25-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2018-09-12:/2018-09-12-tire-society.html</id><summary type="html">&lt;p class="first last"&gt;Tire Society, Akron, OH&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;Tire Society&lt;/strong&gt;, &lt;em&gt;Akron, OH&lt;/em&gt;&lt;/p&gt;
&lt;img alt="First time in front of such a large audience." src="https://lh3.googleusercontent.com/zfciYIV-Jb8SrG3rkqVaagMX7JbQW25udAJwTbq3zSqNf-y-5xMJdw8QlH76WVIBB_nY0tEKAy68nRczf4AYMrK86ay_Kfa4BDfFuXPTOR7khUnxq60hnLDFiwYZuJxOMRpAb6_IFOU=w530-h678-no" style="width: 40%;" /&gt;
&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;The art of rubber compounding has historically been mastered by a small group of experts with extreme breadth and depth of experience. The rising trend of fluidity between companies is making loyal lifetime &amp;quot;sage compounders&amp;quot; a dying breed and organizations must find new ways to capture and archive experience despite having turnover. Minimizing the time before a new hire becomes productive also becomes critical.&lt;/p&gt;
&lt;p&gt;Complex interactions between raw materials and processing make &amp;quot;rules of thumb&amp;quot; insufficient for discovering new technology. These guidelines, even when properly captured, are often overfit to specific scenarios and can be skewed by human cognitive biases—a disadvantage that is especially detrimental when exploring new technology. Machine Learning, on the other hand, is a method of encoding &amp;quot;experience&amp;quot; based on many observations. Industries that have been revolutionized by data science include algorithmic trading, healthcare, and retail. Just as data has taken the art out of sales and stocks, so too could it allow for more accurate formulation development and reduced cycle time.&lt;/p&gt;
&lt;p&gt;Two main challenges affect the amount and quality of data that can be acquired:&lt;/p&gt;
&lt;ol class="loweralpha simple"&gt;
&lt;li&gt;Many of the standard tests for raw materials are related to verifying material identity and purity rather than predicting compound performance.&lt;/li&gt;
&lt;li&gt;Even in the largest rubber development laboratories, the number of material-to-compound observations is relatively small compared to the vast amounts of data available in other industries.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These challenges will need to be overcome in order to develop models of structure / property relationships to evaluate, iterate, and tune each component of a rubber formula and quickly react to business needs.&lt;/p&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="Tire-Society"></category></entry><entry><title>Using Termux: Creating a first class Python environment on Android CLI or how I pushed mobile development too far.</title><link href="http://blog.y2kbugger.com/2018-06-15-cohpy.html" rel="alternate"></link><published>2018-06-15T00:00:00-04:00</published><updated>2021-12-04T16:02:25-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2018-06-15:/2018-06-15-cohpy.html</id><summary type="html">&lt;p class="first last"&gt;COhPy June Meeting, Columbus, Ohio&lt;/p&gt;
</summary><content type="html">&lt;p&gt;&amp;#64; &lt;strong&gt;COhPy June Meeting&lt;/strong&gt;, &lt;em&gt;Columbus, Ohio&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://drive.google.com/open?id=1I6jmlPeBjosl1zJ_XNTXPfcvKGAKvzoYqedefctW6m0"&gt;Slides&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="abstract"&gt;
&lt;h2&gt;Abstract&lt;/h2&gt;
&lt;p&gt;So you've tried QPython but it just doesn't feel complete? Not sure how to &amp;quot;go mobile&amp;quot; as laptops become uselessly obsolete? Whether you love VIM or not you'll enjoy having the full power of a linux CLI to manage your Android Python development environment. Combining the Termux package repo and pip allows installing most packages directly and building many more from source using clang. Pipenv and git can also be used to synchronize development between your phone and other environments, and if you're a vimmer autocomplete is just a few extensions away. Data scientists will also enjoy the unexpected interactive support.&lt;/p&gt;
&lt;/div&gt;
</content><category term="talks"></category><category term="COhPy"></category><category term="Python"></category><category term="Android"></category><category term="Termux"></category></entry><entry><title>Bread I - No Knead Recipe</title><link href="http://blog.y2kbugger.com/no-knead-bread-one.html" rel="alternate"></link><published>2018-01-26T18:11:00-05:00</published><updated>2020-12-14T12:09:04-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2018-01-26:/no-knead-bread-one.html</id><summary type="html">&lt;p class="first last"&gt;On a whim I decided to bake bread.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/nYJc12HSGYu5zAw82 --&gt;
&lt;div class="section" id="my-first-shot-at-baking-bread"&gt;
&lt;h2&gt;My First Shot at Baking Bread&lt;/h2&gt;
&lt;p&gt;Proofing the yeast in a warm water with sugar. The foam means it's still alive.&lt;/p&gt;
&lt;img alt="Brand of flour and year proofing." class="align-center" src="https://lh3.googleusercontent.com/u0o1ygguOveQt9lYaeh1QjKIWasGPc0oKkZQLQkMUWOZzFbES8x2XOtn8kuD4tXcqiNiWthSvEjAGtxgZmqAgleWQj11rLGTHANindMiOlZMEO73yCk3R4K1lVXb-6Xnv087It9d_D3uxvgmqA3P1M5WfBd6lg7JJWIqr_fsbTNolVgvREDi4xK7drzxmB4cGvZvdQ-NirobLN5JSdYzWqCUyU7U86jZ0K9Jh1KSVp4eMz7OrQ5NE5ROkPdwmBGvMUfdM8FV4Ay0l4QLyNahHiZ3XEbCKFFmY-2KB2wFmpAAIgtfMgeLibYHztkWsGzv8JPAXxl5WDkcPPl9SeX5vtomEF_V8fvZbu-t_8ooAn6E2vv6JhujH1amm9Q-rwmiDzIw47G5DF5iVmUWqMbAUtnkvlYjtjLT1dNta4XMKCxLlZqKAJBxapl-EAtyZcvYIejCmxA9uIwpVETr1-CSSKI6MZWZGA4YwxbNAzYjUp9khn7kzm7BqM_KdnPc7TqKlfJ0SLoAtCbIhSPU9HfiaLss_PdfdU6rU3xuTxbCV49dDo88ECwMmMu94Q4XAOXc-R72XpqgSaEPkn9oQlKlBpAYKipcElGIgg4_ZJ-NtEZkiQ4WNdS7lDRZ5nG_EpOWz6VMupCNUGmqgVE-ZN8hXHm-m59p3gtCTHXMg3tFczdB89BVYWamPz7FDg=w683-h432-no" style="width: 100%;" /&gt;
&lt;p&gt;Mix flour and water well, then incorporate salt and yeast.&lt;/p&gt;
&lt;img alt="Mixed dough." class="align-center" src="https://lh3.googleusercontent.com/vq6qyUkoFOqdsCYDlI9kB74CBmDURirDPswQpRcHHO6tFlZercESITS1xxlw7QUwWyyf3PXE9Ro0VZH4QNQDdbY1lS5bQUn37_D6xGN_SU5SKKWtJ-5Nf9Fd8LgpLH9ms3sRgJg2bJht9BpoM6xECEjMtenc1egsFVPn53DCjo_xJB85wz2a0L6jHuWrL8ObXL4NfVAqT0q_HEkVX8Dn2Wwz3Rf6c0XMKlWg_kG-6Dt4rDsd8SFQ7GVK7LorWFJ_29nq94Oqmf9XDhAHVVoOsvpCyHOTT45gzyEDiJW_ZXF86CtZGg2Yk2uIBIg1sdZBcZzxm6a2u1dInG6Tz3AEkk69N04KSvPVRGRuVxcxsZl-AjyYdyEO8y2VLApuwFfvWSVjMF8h2nMmMNkg2LCicyvyY7rbexxx_Z73aou79eSlY48LJDHusxuDtrznwM_QV37LZ6YECDAFRhIukJt6Imu_zEkXQ-4tEZQvkA-62w99pJUS1q_CEaXWIiLK0Ok2gXkux9MBVTD3rLX7q9oNGuFKPBV5a8mf6y7UV3_bOzl0j8ZMXzt9udi-bzcxFu2Q6FR-xrElHLl4ujJJYO1TiyTw_KBbfagpwcAZsnllKg_zme31NaUUNR8lZZfZq1FJNzfia7eY4hYS8BNWFxmdpRoHPxasXKqyeITvKLWs7JHAUWXTncPeuP07Zg=s655-no" style="width: 100%;" /&gt;
&lt;p&gt;Yeast doing its job.&lt;/p&gt;
&lt;img alt="Risen dough." class="align-center" src="https://lh3.googleusercontent.com/3e48QwMiLjH489T4c3DAzd54VIHm14X7puZfqhP0Y-mg3bQ_IuP9zc0XazoFpTmX75vtflOh-jWN0MpWgtDYYup4iUkReOIRXrhDCp5HQ61v7qbVp8nqoKilMBj3kQGpQWF-Ynes1cu-6LGnjYTrNkq_n4jWyvF_KuE8ExIDszWGsbXNEE7DOMWTNyQhM00d4N-U61BhuJdy7TaxEf9GQLz-XWe_U93OokXAk9rqFfEstfcrALYWuIFoUkfBO0Sj6sh2ghcw5m8eAKEUzbPWlvvXA0Q1t92A6hZ5kIDZ_obYKbhTZR8I9S7Jzds0preMjzCJ_hQxbO1ZBEbd9LSZdZVDViw8075ubTh7xwmXZoNbf33vuKyrAoZLTXJj6LZe1tt9Z4WfVBI-HAdCwadEiB9JEPECgCrOsbGfd2zFQmm0eqtMFlFwqNiUduFkIas2IrgUexErGKYsVjBeNK2HaXmuvUetMusBTf3EtwfC_feVp2wIVzyrWi5tesjlv4twdI87gWKkYeeJx2tmvwDSUrKybRcSWtgkBOzQQDOI1Xt3dtVdAvpdl7eG5CaD_WkofZ40WGRT1DI6RXvoHH8U8MxxphRtET_LXAGRgSqYaNnwyO68rSFn8DpXJ_wbGJ5HmugwUlumDyfNKB-ExnJdGJk100C7OTF5GRwxNofjNyC2VkYkz3ZV4zzV3g=w492-h655-no" style="width: 100%;" /&gt;
&lt;p&gt;Proofing dough in a frying pan. Final rise is to allow the gluten to relax enough for a big rise to happen in oven.&lt;/p&gt;
&lt;img alt="Proofing dough." class="align-center" src="https://lh3.googleusercontent.com/ZCTGUWxaDspmJhfSdFE8AP9zjOoNR8SXn2aNBuTV1DCkl16MrOrdVZPGr0a3gox_whovCYpIH_bP4sed9_ENXra6tXkNMJMFvY5jxtjtLwrJ5o-IsGH9voAWHCjiCuzV0AuuLOQHV90Zjgn1jTMzOuXdh_KwED04yTjOZtzus2m2xry4u6oWlFEw3f_dx1B_voKeDTplMHdfNIRIlcuFW5kYwMyyIatAuguoOsCGcd738buJ0ghxzunPnasMOWCFu2IM8wW12jTW68cP5m-catu0aOntOYSUOFOp3q_ldVMcIdBFi3-OoTIj3cRd0BWyepiLCnycWFpe8yCJgKh4CNItAKvjqldzUGp-HkCU7-621rDLmqs5diBr3udMEPbuWGqT7TZkSe4YOhUR__96IpX5TN4J229h290DJnQ5tEl-nj9LtriZ6iA16TGFAn_9a0DAB4Ie77jYsrlPikrSlgFRtiQ5clw0Al2-mYJyuOHoAiMIjj_SJN7IfefCf2M98nZIJHv0_FkuPjN0JlUJp3YLoKA5Ny5HcKysUs9va8wn1uqRT9G4eCBoB_5yks86UYJ_MPQyssoAFhe2JVH3ZWPRj13eR76lrRy9QBcvZDGa3Fhdebc_6KJza0s58PzFv8IkjHX7EOn3Bcphf2heoEb17yr47_TLP_BD3-wMfs9td3ixPeI6Pdi1qg=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Flipped dough into a dutch oven. Cover and bake at ~450F.&lt;/p&gt;
&lt;img alt="Before bake." class="align-center" src="https://lh3.googleusercontent.com/tgtxE99wy8WLvDUJGtiOkyyBgI5-T7OW5j6GrB7k1PxSpScnxTVuIRICkP3qaJRMmlCVMj8aqaZvHbHZQ7ev_mw-iMp43uEgHy8Z0h_Xm4P-rxemZtcSqZnjATvfM6MfEElq7ja_45T5MEL33B_VEmJZbbqbQytuuLLix1GsXCZ4vAlaXsFcwaYVvoAURioIsQyRcuDe90eAkvq7yPykODx96VjNhm8l0wNvcYVBL_DdiBiVIG7if4XhApHhvX-vAgcmBj8tNjdbVrLybRK8X8ag9n8pyMVxn1_I411VoE4XHMOddZBJJ--lm4P-OVNfFkBYqBxmak3rMyWVARzRYP-iBdnkRFemCH8L2OZsqiPHWBJKXJLBr-R7BsZa45G_uQRXqwgVW74NzLMg3c7pk9ibEs0Nyy8OMOYCUvxHZkOgrYA_FIUrAk1J53glRr8jIenaBNRzQY9B_Oy_R_KjK6G3XrIHz3rJS_kd-dUqrNmOHK7xQJRLGm4FR2_n5qs0adxUP_7jZbcPUBS_nMw1kYlt9uVWdRqsnx9qjtqhSa1sYUbmxEbx4aUsM0-yg3ztLWl3gHl4lwfjgxBJNED8Yplzq6UsYmwtj4Ko1BcT3YpZGIHJ70TyXQGbnHoTJx7WofDXIwbTR4GvzWDxwfIp6wScsHRFpNlLG27dakPFw1QP_oBd6r5xgMyxFg=w683-h513-no" style="width: 100%;" /&gt;
&lt;img alt="Fresh Bread." class="align-center" src="https://lh3.googleusercontent.com/0HFdWBGE3T90rz5UNIUaIV8xrRm-VFIO3i3x48O6322b9GWA1BIE0F_tBjpBwsbkduObigapGSFZWN4g8si4tKNxX7C-j1AD9-vpmnyIpvrCBrIu12SAxw6kGKzASPefMnhEpyTc7yTVJMFJstto2HRKxd6zmDxK0rLmsBPGNG-oZS3jHanXeaPqiC8ZYcnq1iwTity7Bm4lszBrbnkW2fuopEij8Peji95DVHwpPyJ9onwbzbgB-imYpT-ylU0_9LODCEPwCZl1W7j11ALkMH5uJ7eCPE_5ReA4Sd-hrA5ceGrSFVPYbY8M_UexC6W1yWC0zGMAJUW4AIlMeqSJjRJKvji_-gsXVe_YnBETs22M6XPpUgDtT0N4CtxwknyvCKav_d7obzEUdkmmuKzprPvj0LXGkGoIDYoEExYXx8jOK40FrEIvW0kO83neWu9YY9i0CXwyZ5N_yqnEszTxMaxBgLjN3LTPB8SJxOOiQRAw1YMMwpscgwvnd3AwHpJrYS9RL9wPHF1k-tkG334EDba1O3_0ePflpSdOSigBkyyCTXQn28Sl64D0UF6wUG_KC2ObPU4s295YvBVLDNzuwxfvJjATIMEvX7id6goO929-G_S2tBadZGo8d6YeB4CWgurEz-9xZNF6TtfRlsaxsg8Zs-FqtjupYROLERxSJ04mtUUMSL8ec1HP2g=w683-h513-no" style="width: 100%;" /&gt;
&lt;p&gt;Success!&lt;/p&gt;
&lt;img alt="Good Texture." class="align-center" src="https://lh3.googleusercontent.com/Ct3rJTS_W9PUlWKnM86XUgSNlsH468-llaz-A_yY09DeaALtC5I-6CzasK7I0DN7bNkD-9vgtbF8vS3Ds_RanoBia0n2dZWXAXLYRuEz9n_boB-J1qNrNhwmMU42JX-04x9XO5kvZ7U1OzDXe9QV2jSA65umzzulBJkCUzluETswOPVB-z2o_gLWo8nTUC68_NeuN5achEVYua_baoJs94VPQpG08N1sdtaJCsLjWJgr7nr30cPGccosY0PpGPSajIhGEcDopmqYb_XQTUPY3qDj-VWhvTpBq2Qzak7RDUHKLi0gvrL_wPeABnfin6uhf19VqUB4ZUe2SaHA0qwumCgW1EsCdOFm262wf-XaAPdnWS3f8VFSVnGviHsxETtao3JFM7Z0M8zBvqLXLnpoASVWaHkD8tQI_4e1EU1EgjUhbagxs1kceL5mNjTLMUfcAruZTxL8FzefYaC5ic9XGWSsr2GL58YZsdDdybugyZlQAb_qDbMA_OdVtcbDvAoCrUvZqbSyHBn8_wxkxkacDbq4ac_eyTB8B1BSGHh5CMUq3Lt73O_ecY_gp5fjp8r8g6iiiVPmahyw5kmnvEzKg2POMuQaUF4Am-ENHj_YIJKAqQ_uGX6dfI9QHZXDcjTLvOUNarPcNwgbstDUqQNAR3kIRz9lwOnL_0eGW8Wj_vJsn67a-1auFpcAog=w683-h447-no" style="width: 100%;" /&gt;
&lt;/div&gt;
</content><category term="food"></category><category term="bread"></category></entry><entry><title>A Compact 8-bit Bus Display</title><link href="http://blog.y2kbugger.com/compact-bus-display.html" rel="alternate"></link><published>2017-12-19T20:58:08-05:00</published><updated>2020-12-14T12:09:04-05:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,2017-12-19:/compact-bus-display.html</id><summary type="html">&lt;p class="first last"&gt;Prototyping front panel display components for a Z80 or TTL minicomputer.&lt;/p&gt;
</summary><content type="html">&lt;!-- Google Photos Album: https://photos.app.goo.gl/XnXEAZp8C6Nqg5zJ3 --&gt;
&lt;div class="section" id="binary-hex-display-module"&gt;
&lt;h2&gt;Binary + Hex display module&lt;/h2&gt;
&lt;p&gt;What started out as a way to work on a prototype turned into a pretty cool display for a modular trainer.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="motivation"&gt;
&lt;h2&gt;Motivation&lt;/h2&gt;
&lt;p&gt;I wanted an easy way to glance at the bus signals on my breadboard Z80 prototype. The goal of my Z80 computer is to learn about about what a cpu does, and watch it interact with memory and peripherals.&lt;/p&gt;
&lt;p&gt;This means having features such as:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;writing to memory by hand&lt;/li&gt;
&lt;li&gt;stopping the clock&lt;/li&gt;
&lt;li&gt;single stepping the processor&lt;/li&gt;
&lt;li&gt;observe the state of the buses and I/O&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This can be done either mostly in software, or mostly in hardware. When it's software we call it a monitor program, and for hardware it's commonly called a trainer. In my case, I want to add these features in hardware.&lt;/p&gt;
&lt;div class="figure align-center"&gt;
&lt;img alt="altaire" src="https://lh3.googleusercontent.com/pw/ACtC-3c0ghd2mox_6hFrde8tAXjk7DmhvGc71toNKh900qnj-BGMrMak8hZIL-LTVTdHAnEpbCeGC6tg72ETeG5O_yvcOw711jkv_MOECR1ghJIHX8-UBPcf0WgHlSIDumMk3i1R7e-_tDzwGP2CDNyK-RvCLw=w640-h273-no" style="width: 100%;" /&gt;
&lt;p class="caption"&gt;The MITS Altair 8800. One of the first personal computers.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Flipping switches to bootstrap your paper tape driver &lt;a class="reference external" href="https://www.youtube.com/watch?v=5zbtNImG2NE"&gt;is very humbling&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;My trainer will be based on the Z80, having an 8-bit databus and a 16-bit memory address space. The first step was to get the cpu up and running and verify that the program counter was working. This can basically be done with resistors and power and a single LED. I got a lot of inspiration from &lt;a class="reference external" href="https://www.youtube.com/watch?v=AZb4NLXx1aMchip"&gt;this video&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="input-first"&gt;
&lt;h2&gt;Input First&lt;/h2&gt;
&lt;p&gt;First, I prototyped the &amp;quot;Keyboard&amp;quot; module.&lt;/p&gt;
&lt;img alt="the keyboard" src="https://lh3.googleusercontent.com/pw/ACtC-3fE2a-FpZLw8R6JkFSXoGRJ1Nfz_cHQOcbysIO11ySk9vkcqz00k0kcQITJES1ocRBrjHBSg4lDK5fZIIMVibu_l-NFW4GeA9fa_yBWb1nCgNYaKbCQ_Qp6TiIMvMiBsvjLeuT2U6j9kyVmKFVOBjoMpg=w960-h940-no" /&gt;
&lt;/div&gt;
&lt;div class="section" id="simple-prototype"&gt;
&lt;h2&gt;Simple Prototype&lt;/h2&gt;
&lt;p&gt;Next, I wanted a simple way to test the keyboard module separate from the Z80. First I prototyped on a breadboard as shown above. The next step was to compact it into a module.&lt;/p&gt;
&lt;p&gt;I wanted to make something compact that could be put into a breadboard to peek at the signals on a certain bus. I fell in love with the way the LEDs, resistor network, and header went together. This is functionally equivalent to the breadboard version shown in the &amp;quot;keyboard&amp;quot; photo.&lt;/p&gt;
&lt;img alt="first 8 bit display prototype" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3dy7Eit3PbmaET6c6RsvxJtBAN3B4c14yo7qbImlrWUBt9yPcNIiw6sbGSteRL0b3DI9h51ugACrEwIm6x4eLPJNslq_RJj4ZWvpWGTe8rhIFcsnakEeJhLvKCTeq1RfZGN5K2UA81C0XTfE-k_5Vj3Gg=w405-h678-no" style="width: 70%;" /&gt;
&lt;p&gt;But alas, this design had a problem.&lt;/p&gt;
&lt;p&gt;I was getting some weird results when testing on the real Z80. I though I just needed to tweak the resistance to something less power-hungry. If you draw too much current, you might influence the levels you are trying to display. This would interfere with the operation of the Z80. I asked the datasheet: &amp;quot;is it possible to have a low enough current that I don't need to buffer when I am on the data bus for instance?&amp;quot; My CMOS Z80 can output one TTL load, so yes, but because it is active high but open collector you cannot source enough current in the &amp;quot;On&amp;quot; state. This is compounding by the fact the TTL levels are not actually 5 volts and therefore it might not actually have enough headroom to light some voltages of LED.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="buffers"&gt;
&lt;h2&gt;Buffers&lt;/h2&gt;
&lt;p&gt;In order to overcome the issue of sourcing current, we can use a buffer. This repeats and optionally inverts a bus of signals. This solution probably seems obvious to someone who has worked with open collector buses before, but it took some research and deep reading of datasheets to understand what as going on here. It seemed overly complicated but is just the reality of open collect style buses. There are modern replacements for this such as tristate which pull in both directions but also have a high-impedance or 'Z' state. The Art of Electronics as a really good chapter on interfacing with peripherals and it covers this quite well.&lt;/p&gt;
&lt;p&gt;This is the first prototype after realizing I really would need the buffer.&lt;/p&gt;
&lt;img alt="8 bit display" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3fCsSxakX4v-i5FCPm6vPRPEihtgqh8RpKpm1WuWQ5-h8Bp90ppqkQuCbi0IrAuOBX9LJmMCpq-YQP7Oen_cojJzra6_5WGsbq8lr4UIJz5oYpuVbG9QH3msjh4FqVyVTq4XJYbRdBX6GXYwJSPPjj3uQ=w521-h385-no" style="width: 100%;" /&gt;
&lt;img alt="module interface" src="https://lh3.googleusercontent.com/pw/ACtC-3f5DpQtjzHHn8lq-yZM5X3mvM0KQHAO14yNFm6HxLgLdGr4tzcYancILEd0jg46RlqVD_Gquh9M3-vWcvUZLO7FdeF4_7z6loKC0K7Nv8KiYo3timjQH-OsBBlTBEnvK0QYJlYpxSW2jcpoTPBDEWTCNg=w960-h720-no" /&gt;
&lt;/div&gt;
&lt;div class="section" id="hex"&gt;
&lt;h2&gt;Hex&lt;/h2&gt;
&lt;p&gt;Then I found some really cool hex displays on ebay. These have all of the decoding circuitry within them and so are easy to interface. I kinda became obsessed with this simplicity and so I found some rotary switched which have the hex encoding built into the mechanics of the switch.&lt;/p&gt;
&lt;img alt="8bit Dual Hex Display" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3dU-LMcUtXz-VFN-DtQIAu1TvNrymMRF7iTXfd_Lu285yQRt8Ia-CxIuPeXT5uCcOfsdNSyiImny9eodmNzx3366e8Fj5bKM6ZLFn-lvrPHXvod9bzuWCVOt8SKcXt8yCZUnuu2DWatDmheiabl6pf_Jg=w742-h989-no" style="width: 100%;" /&gt;
&lt;p&gt;These switches are used in &amp;quot;Keyboard 2.0&amp;quot;.&lt;/p&gt;
&lt;img alt="8bit Dual Hex Switch" class="align-center" src="https://lh3.googleusercontent.com/pw/ACtC-3d0Ws9WxGmbQcTa6gQo1WtSDn93HyQIFef4npbmYf6iQtYDPny-oCxkz81sOERbAXTqjwByfSZWgF4JzVUIbXkG3l8GLN_8myWvce-xSFMXxROrSkDHp2s28Emio5u1M974dw7_zoss7AwC9ZK2GkUriQ=w961-h670-no" style="width: 100%;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="finalizing-the-hex-display"&gt;
&lt;h2&gt;Finalizing the Hex Display&lt;/h2&gt;
&lt;p&gt;I came upon a kit for making 16bit ribbon cables that fit right onto header pins. I incorporated this into a tight layout but I wanted a clean way to do the point to point soldering.&lt;/p&gt;
&lt;p&gt;After some research I found a good description of a method here: &lt;a class="reference external" href="http://elm-chan.org/docs/wire/wiring_e.html"&gt;http://elm-chan.org/docs/wire/wiring_e.html&lt;/a&gt;. The suggestion to build a self tensioning pen is great and the quality of the result was impressive.&lt;/p&gt;
&lt;img alt="Example Wiring" src="https://lh3.googleusercontent.com/pw/ACtC-3dgPGS6tIFvmjc0gPdEpUCdqg5weQKgYh5o3MoA_neKh27fXzBm3aP_ATOJqVHAGDN69Fe8zo-9bJxO-rXvuUu9fftDFphJhYZ0agR31vsqVUdr6gr4nxStLchkKfHXvPS46CnzKj8NWtdTxHx_plyl3g=w363-h323-no" /&gt;
&lt;p&gt;I was inspired to replicate this technique.&lt;/p&gt;
&lt;p&gt;Here's my toolkit:&lt;/p&gt;
&lt;img alt="Home made toolkit" src="https://lh3.googleusercontent.com/pw/ACtC-3exmk66BYn7wxr9Q9NwvLEuGKt4yzEWtqVquo6iev10d8Hf3UwvPej9Zap-QMEYEclulRcfgodmNR6B7OJ2IvZTdL0LSp9EstOVsPzknRKCCqWtIt0Q0O3kXXsv9jOmelLwlVg4tRBGD-ljDzqSqtzQ5w=w960-h723-no" style="width: 100%;" /&gt;
&lt;p&gt;Tension kept by the viscus damping of a kneadable eraser.&lt;/p&gt;
&lt;img alt="Tension kept by the viscos damping of a kneadable eraser." src="https://lh3.googleusercontent.com/pw/ACtC-3ePhwZ9b9fIGAGzAA_DDe35N_6GkRLwTrGekPlQyUMnyCYBujFzg-zPQkrmE_Ll6hzvmrMZmaPPBK0L94SeRMX_UT7P2ohYhYi3INMbyPdT5aMiCi9lk3MIthv12Pbzm7cEl--dBQprZYnQKkZRnMtw4Q=w671-h989-no" /&gt;
&lt;p&gt;Amazing how nice it is to route using this simple device.&lt;/p&gt;
&lt;img alt="front end of the wiring pen." src="https://lh3.googleusercontent.com/pw/ACtC-3ezmfiN2uOTWuMyl3MHJzX6RxCn4G41zBZFEJe9LNkCR3SJb-fjD0Mx3JTCJ2pE-0nD6SaByJltRPGrJc_ZNtfMOOR9WT6ONl2HjGrsPmnIH3zT-xpeTQZYTdUq8L_LdJdn6bYt1gh7HsnQGqh0Bqi7rg=w752-h989-no" /&gt;
&lt;p&gt;First layout&lt;/p&gt;
&lt;img alt="Original Layout." src="https://lh3.googleusercontent.com/pw/ACtC-3fqebsm0GTx7DqcircrdSlbVc5iyjbnIW3YTWwTKk3lCJ6AjnPWBSsws5IZSn37T9HsL__UqSfRB9oZ3uS9cL4GE9M_bmOd19GwdK3qwRGjX1bcGsvOvS4mV0pdO3c3B3N80lT-sFYV5zS-US1pKrsytg=w787-h989-no" /&gt;
&lt;p&gt;Hold the pieces in place with gaffers tape&lt;/p&gt;
&lt;img alt="holding pieces with gaf tape" src="https://lh3.googleusercontent.com/pw/ACtC-3fXwmP759cJQh0MwywwbvuxqR2uZl5Y1IkEZBU-FXB-QuBgzgQg3VVT3k24ibbBctvESS_WDwbW2iP5wc6sjAnkcMa1uXVy00cw1Ulza3YZo3U1Tatj2B0A5LGqHJgMLXEwo8EwpsN4u9JO7lm2iBY5yA=w742-h989-no" /&gt;
&lt;img alt="Fine wiring" src="https://lh3.googleusercontent.com/pw/ACtC-3efzzHBPWMn256AYGDUWSWhWS0ZYvOlyQ0KWivKxk7cvamg7CBJDLHTVfMd6ASrW2ew-Gkky5aQRufsOJiGiRxgPcsnItF51LuW95ftM3qgUq0IbFDAJSoF5kSJuRxAQPwWin_tpZesOul9nyvg2z_j6g=s960-no" /&gt;
&lt;p&gt;It's alright to have crossing wires because we only remove enamel at the solder joint.&lt;/p&gt;
&lt;img alt="Backside, crossing wires" src="https://lh3.googleusercontent.com/pw/ACtC-3dXtlvsc8phKZQBTGvsIZoRiU25C0tyOfv3nC4Mg0fyfl94NLjZ39e_keXr6QC8AlLCuDtA-nOlJy0J0wFomY4-3QwpOYGpuebMZlzxSF5BpLSX3UdYd99hwPhsSZDdPo-LGz7dxFyVkqpFUq3_wyNIJQ=w570-h989-no" /&gt;
&lt;p&gt;These two devices are equivalent, each having a 8 bits of hex and 8 bits of binary. The final module is satisfyingly compact.&lt;/p&gt;
&lt;img alt="Size comparison" src="https://lh3.googleusercontent.com/pw/ACtC-3dNRdys80vZDo2Yjc06wpy94Xq_PGtWSMmVyGzDddIox1RXK7uT77T6Qt2JKLiGai-1ERXvmmGCHEtdszBy4o-rw7gcMQbiSZFGS6iZIJcn2wDPkqvSFyxC0QwO1UJ_q4-tshn3hiKMIPuqbV_6T5koyw=w960-h775-no" /&gt;
&lt;p&gt;Driving the finished module with an ardunio to test.&lt;/p&gt;
&lt;img alt="it works" src="https://lh3.googleusercontent.com/pw/ACtC-3eclInsbfzOgu6H4e9nNESdtCFPdL3JA8iWfcpG9dvcJC5xj554EXis4rYAPzbyzwEWUKt2jIbGPfvSvXZXH75SE8wOwV9YGUYm54DPQBwuf_cZl-7UE4JmJSdQEOK7iy8CKXLjYMo-hvA2m8IOohrK4Q=w617-h940-no" /&gt;
&lt;/div&gt;
</content><category term="electronics"></category><category term="retrocomputing"></category><category term="display"></category><category term="resistor-network"></category><category term="z80"></category></entry><entry><title>blog.y2kbugger.com - Timeline of my Projects</title><link href="http://blog.y2kbugger.com/origin.html" rel="alternate"></link><published>1991-09-29T00:00:00-04:00</published><updated>2020-03-28T22:16:59-04:00</updated><author><name>zak kohler</name></author><id>tag:blog.y2kbugger.com,1991-09-29:/origin.html</id><summary type="html">&lt;p class="first last"&gt;I explain how I use dates on this blog. The purpose of this blog is to showcase my projects past and future and so publication dates shouldn't be taken as the actual data the article was written.&lt;/p&gt;
</summary><content type="html">&lt;!-- https://photos.app.goo.gl/nBk15GV92Uvt7ZzF8 --&gt;
&lt;div class="section" id="purpose-of-this-blog"&gt;
&lt;h2&gt;Purpose of this blog&lt;/h2&gt;
&lt;p&gt;The reason this site exists is to track and showcase my various projects. I
value having an accurate timeline of when the projects were worked on more than
when they were written about.&lt;/p&gt;
&lt;div class="section" id="use-of-dates"&gt;
&lt;h3&gt;Use of dates&lt;/h3&gt;
&lt;p&gt;To have an accurate project timeline, I will make the date of an article be the
date when a project or stage of a project was completed. So you can still know
when an article was publish, I will use the last modified on field even for new
articles. This not only ensures an accurate timeline, but it gives the
opportunity to go back and curate past projects.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Young zak at the computer." src="https://lh3.googleusercontent.com/D9Q1Ag8tAEmQIo8cJ1ChfEAlZyodx60aHR4XBwUe7_GGb8tKOI49lfPno9FuFTM7c2khVeDTgpiMmhsKOLeDmUlhb8gw-AHKMUyPGVhKpjBuCrogEpsvu624IUwYNs3OBCGb0Xhk1kw=w683-h483-no" style="width: 100%;" /&gt;
&lt;p class="caption"&gt;Zak circa 1995. Some things never change.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="historical-stubs"&gt;
&lt;h3&gt;Historical stubs&lt;/h3&gt;
&lt;p&gt;For some historical projects I plan to just make a stub article and include a few photos. If there is interest in any one of them in particular I will update with more details. This can also just serve as an index for when I need to showcase my talents; I can elaborate on them in person.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Ohio LinuxFest 2019" src="https://lh3.googleusercontent.com/E5Je4pWOapBTC3A7eaTcEpl_esrlSkCLIOaj8OueJ7mQg6WDiBAqPInbkf619wPP1gWmUy6exkZLEA_479kfIZCMMSbIqm2_Zn4_6qM9qcpQEYnqxc8Rzm8AjJbj_K8YqIhOKlrNg2A=w683-h455-no" style="width: 100%;" /&gt;
&lt;p class="caption"&gt;Ohio LinuxFest 2019&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Thanks for reading, and I hope I you have found something useful or entertaining here.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="Central Ohio Python" src="https://lh3.googleusercontent.com/SZuGLUx0uXaHjoDduwtfltstTODj3IQZoPAZ-bElZBDGAboCR8IvGBfhDTR8DSF_UDx285XJDNt0H9ZewtDJZ0hZgnU7AJBOCDX6HgU84aanZUNtithhRoqhpirQUBpVYRST6bIe6Yg=w683-h511-no" style="width: 100%;" /&gt;
&lt;p class="caption"&gt;Central Ohio Python, 2018&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="meta"></category><category term="origin"></category></entry></feed>